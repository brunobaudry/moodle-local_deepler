/**
 * @module     local_deepler/deepler
 * @file       amd/src/local/utils.js
 * @copyright  2025 Bruno Baudry <bruno.baudry@bfh.ch>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_deepler/local/utils",[],(()=>{const parser=new DOMParser,replaceKey=(s,k)=>s.replace("<KEY>",k),makeCookieName=function(config){let oldWay=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return oldWay?"moodle_deepler_glossary_"+config.currentlang+config.targetlang+config.courseid:"moodle_deepler_settings_"+config.currentlang+config.targetlang+config.courseid},setCookie=(config,value,hours)=>{let expires="";if(hours){const date=new Date;date.setTime(date.getTime()+60*hours*60*1e3),expires="; expires="+date.toUTCString()}document.cookie=makeCookieName(config,!0)+"="+(value||"")+expires+"; path=/"},getCookie=config=>{const nameEQ=makeCookieName(config,!0)+"=",ca=document.cookie.split(";");for(let i=0;i<ca.length;i++){let c=ca[i];for(;" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null};return{debounce:(fn,delay)=>{let timer;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];clearTimeout(timer),timer=setTimeout((()=>fn(...args)),delay)}},decodeHTML:encodedStr=>parser.parseFromString(encodedStr,"text/html").documentElement.textContent,getCookie:getCookie,getEncodedCookie:config=>{const cook=getCookie(makeCookieName(config));return null===cook?null:atob(cook)},getParentRow:(node,selector)=>node.closest(replaceKey(selector,node.getAttribute("data-key"))),fromBase64:encoded=>{const binString=atob(encoded),bytes=Uint8Array.from(binString,(m=>m.codePointAt(0)));return(new TextDecoder).decode(bytes)},keyidToKey:k=>{if("string"!=typeof k||k.length>256)return null;let m=k.match(/^([^-]+)-([^-]+)-([^-]+)-([^-]+)$/i);return m?"".concat(m[1],"[").concat(m[2],"][").concat(m[3],"][").concat(m[4],"]"):null},replaceKey:replaceKey,setCookie:setCookie,setEncodedCookie:(config,value,hours)=>{setCookie(makeCookieName(config),btoa(value),hours)},smartTruncate:(str,maxLength)=>{if(str.length<=maxLength||0==maxLength)return str;const trimmed=str.slice(0,maxLength-"…".length),lastSpace=trimmed.lastIndexOf(" ");return lastSpace>0?trimmed.slice(0,lastSpace)+"…":trimmed+"…"},stripHTMLTags:str=>(new DOMParser).parseFromString(str,"text/html").body.textContent||"",switchLocation:(addParam,removeParam)=>{let url=new URL(window.location.href),searchParams=url.searchParams;searchParams.set(addParam.key,addParam.value.trim()),removeParam&&""!==removeParam&&searchParams.has(removeParam)&&searchParams.delete(removeParam),window.location=url.toString()},toJsonArray:function(s){let sep=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return JSON.stringify(s.split(sep))}}}));

//# sourceMappingURL=utils.min.js.map