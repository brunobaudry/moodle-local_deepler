{"version":3,"file":"eventHandlers.min.js","sources":["../../src/local/eventHandlers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  description here.\n *\n * @module     'local_deepler'; // Full name of the plugin (used for diagnostics)./local/eventHandlers\n * @copyright  2025 Bruno Baudry <bruno.baudry@bfh.ch>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n        'core/log',\n        './utils',\n        './translation',\n        './api',\n        './customevents',\n        './selectors',\n        './uiHelpers',\n        './settings'\n    ],\n    (\n     Log,\n     Utils,\n     Translation,\n     Api,\n     Events,\n     Selectors,\n     UI,\n     Settings\n    )=>{\n        let config = {};\n        let filterTimeout;\n        /**\n         * Event factories.\n         */\n        const registerEventListeners = () => {\n            document.addEventListener('change', handleChangeEvent);\n            document.addEventListener('click', handleClickEvent);\n            document.addEventListener('focusin', handleFocusEvent);\n\n            // Translation events.\n            Events.on(Translation.ON_ITEM_TRANSLATED, onItemTranslated);\n            Events.on(Translation.ON_TRANSLATION_FAILED, onTranslationFailed);\n            Events.on(Translation.ON_TRANSLATION_DONE, onTranslationDone);\n            Events.on(Translation.ON_REPHRASE_FAILED, onTranslationFailed);\n            Events.on(Translation.ON_DB_SAVE_SUCCESS, onDbSavedSuccess);\n            Events.on(Translation.ON_DB_FAILED, onDBFailed);\n            Events.on(Translation.ON_ITEM_SAVED, onSuccessMessageItem);\n            Events.on(Translation.ON_ITEM_NOT_SAVED, onErrorMessageItem);\n            // Events.on(UI.ON_STATUS_CHANGED, onIconStatusChanged);\n            Events.on(Api.GLOSSARY_DB_ALL_FAILED, onGlossaryDbAllfailed);\n            Events.on(Api.GLOSSARY_DB_FAILED, onGlossaryDbfailed);\n            Events.on(Api.GLOSSARY_DB_SUCCESS, onGlossaryDbSuccess);\n            Events.on(Api.GLOSSARY_ENTRIES_SUCCESS, UI.showEntriesModal);\n            Events.on(Api.GLOSSARY_ENTRIES_FAILED, (e)=>Log.error(e));\n        };\n        /**\n         * Focus.\n         *\n         * @param {event} e\n         */\n        const handleFocusEvent = (e)=>{\n            if (e.target.closest(Selectors.editors.targetarea)) {\n                // Window.console.group('handleFocusEvent');\n                // window.console.log(e, e.target);\n                // window.console.groupEnd();\n                UI.wrapTinyOnTarget(e.target);\n            }\n        };\n        /**\n         * Event listener for click events.\n         *\n         * @param {event} e\n         */\n        const handleClickEvent = (e) => {\n            if (e.target.closest(Selectors.actions.toggleMultilang)) {\n                onToggleMultilang(e);\n            }\n            if (e.target.closest(Selectors.actions.autoTranslateBtn)) {\n                callDeeplServices();\n            }\n            if (e.target.closest(Selectors.actions.selectAllBtn)) {\n                // Here.\n                UI.toggleAllCheckboxes(e.target.checked);\n            }\n            if (e.target.closest(Selectors.actions.tothetop)) {\n                UI.backToBase();\n            }\n            if (e.target.closest(Selectors.actions.checkBoxes)) {\n                UI.toggleAutotranslateButton();\n            }\n            if (e.target.closest(Selectors.actions.saveAll)) {\n                saveTranslations();\n            }\n            if (e.target.closest(Selectors.actions.validatorsBtns)) {\n                saveSingleTranslation(e);\n            }\n            if (e.target.closest(Selectors.glossary.entriesviewerPage)) {\n                Log.info('CLICK');\n                Log.info(Settings.getValue(Selectors.deepl.glossaryId));\n                Api.getGlossariesEntries(\n                    Settings.getValue(Selectors.deepl.glossaryId),\n                    config.deeplsourcelang,\n                    config.targetlang\n                );\n            }\n        };\n        /**\n         * Event listener for change events.\n         * @param {event} e\n         */\n        const handleChangeEvent = (e) => {\n            if (e.target.closest(Selectors.actions.hideiframes)) {\n                UI.doHideiframes();\n            }\n            if (e.target.closest(Selectors.actions.targetSwitcher)) {\n                // SwitchTarget(e);\n                Utils.switchLocation(\n                    {\n                        key: 'target_lang',\n                        value: e.target.value.replace(config.rephrasesymbol, ''),\n                    }\n                );\n            }\n            if (e.target.closest(Selectors.actions.sectionSwitcher)) {\n                // SwitchSection(e);\n                Utils.switchLocation(\n                    {\n                        key: 'section_id',\n                        value: e.target.value,\n                    }, 'activity_id'\n                );\n            }\n            if (e.target.closest(Selectors.actions.moduleSwitcher)) {\n                // SwitchModules(e);\n                Utils.switchLocation(\n                    {\n                        key: 'activity_id',\n                        value: e.target.value,\n                    }\n                );\n            }\n/*            If (e.target.closest(Selectors.actions.sourceSwitcher)) {\n                // SwitchSource(e);\n                Utils.switchLocation(\n                    {\n                        key: 'lang',\n                        value: e.target.value,\n                    }\n                );\n            }*/\n            if (e.target.closest(Selectors.actions.checkBoxes)) {\n                onItemChecked(e);\n            }\n            if (e.target.closest(Selectors.actions.sourceselect)) {\n                onSourceChange(e);\n            }\n            if (e.target.closest(Selectors.deepl.glossaryId)) {\n                UI.toggleGlossaryDetails(Settings.getValue(Selectors.deepl.glossaryId));\n            }\n            clearTimeout(filterTimeout);\n            filterTimeout = setTimeout(() => {\n                if (e.target.closest(Selectors.actions.showUpdated)) {\n                    UI.debouncedShowRows();\n                }\n                if (e.target.closest(Selectors.actions.showNeedUpdate)) {\n                    UI.debouncedShowRows();\n                }\n                if (e.target.closest(Selectors.actions.showHidden)) {\n                    UI.debouncedShowRows();\n                }\n                }, 30);\n        };\n        /**\n         * Launch deepl services.\n         */\n        const callDeeplServices = () => {\n            UI.launchTranslatingModal();\n            const keys = [];\n            const [cookie, settings] = Settings.prepareSettingsAndCookieValues();\n            // UI.saveAllBtn.disabled = false;\n            UI.disableSaveButton();\n            Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes)\n                .forEach((ckBox) => {\n                    const key = ckBox.getAttribute(\"data-key\");\n                    const sourceText = Utils.domQuery(Selectors.sourcetexts.singlelangkeys, key);\n                    const editor = UI.findEditor(key);\n                    Translation.initTempForKey(\n                        key, editor,\n                        sourceText.getAttribute(\"data-sourcetext-raw\"),\n                        sourceText.getAttribute(\"data-filedtext-raw\"),\n                        Utils.domQuery(Selectors.sourcetexts.sourcelangdd, key).value\n                    );\n                    keys.push(key);\n                });\n            const newCookiename = Utils.COOKIE_PREFIX_NEW + config.currentlang + config.targetlang + config.courseid;\n            Utils.setEncodedCookie(newCookiename, JSON.stringify(cookie), config.cookieduration);\n            Translation.callTranslations(keys, config, settings);\n        };\n        /**\n         * Event Listener when DeepL API call failed.\n         * @param {string} error\n         */\n        const onTranslationFailed = (error) => {\n            UI.disableTranslateButton();\n            onTranslationDone();\n            UI.deeplErrorModal(error);\n        };\n        /**\n         * Event Listener when DeepL API call finished.\n         */\n        const onTranslationDone = () => {\n            // UI.saveAllBtn.disabled = false;\n            UI.disableTranslateButton();\n            UI.enableSaveButton();\n            UI.hideModal();\n        };\n        /**\n         * Event listener for the translations process to dispaly the status.\n         *\n         * @param {string} key\n         */\n        const onItemTranslated = (key) => {\n            // Add saved indicator.\n            UI.setIconStatus(key, Selectors.statuses.tosave, true);\n        };\n        /**\n         * Displays error message and icon.\n         *\n         * @param {string} key\n         * @param {string} error\n         */\n        const onErrorMessageItem = (key, error) => {\n            Log.warn(`ui/errorMessageItem`);\n            Log.warn(key);\n            Log.warn(error);\n            const editor = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n            editor.classList.add(\"local_deepler__error\");\n            UI.setIconStatus(key, Selectors.statuses.failed);\n            UI.showErrorMessageForEditor(key, error);\n        };\n        /**\n         * Listener for individual source change.\n         * @todo MDL-000 implement in v1.4.0\n         *\n         * @param {event} e\n         */\n        const onSourceChange = (e) => {\n            // Do check source and target and propose rephrase if PRO.\n            Log.info('source changed');\n            Log.info(e.target.getAttribute('data-key'));\n        };\n        /**\n         * Event listener for selection checkboxes.\n         * @param {Event} e\n         */\n        const onItemChecked = (e) => {\n            // Check/uncheck checkboxes changes the charcount and icon status.\n            if (e.target.getAttribute('data-action') === \"local_deepler/checkbox\") {\n                const key = e.target.getAttribute('data-key');\n                UI.toggleStatus(key, e.target.checked, Translation.translated(key));\n                UI.countWordAndChar();\n            }\n        };\n        /**\n         * When a main error with the DB occurs.\n         *\n         * @param {string} error\n         * @param {int} status\n         */\n        const onDBFailed = (error, status) => {\n            UI.hideModal();\n            UI.dbErrorModal(error, status);\n        };\n        /**\n         *\n         * @param {array} errors\n         */\n        const onDbSavedSuccess = (errors) => {\n            UI.hideModal();\n            if (errors.length > 0) {\n                UI.dbErrorPartialModal(errors.length);\n            }\n        };\n\n        /**\n         * Multilang button handler\n         *\n         * @param {Event} e Event\n         */\n        const onToggleMultilang = (e) => {\n            window.console.log(e);\n            const row = e.target.closest(Selectors.actions.corerowid);\n            // Let keyid = e.getAttribute('aria-controls');\n            // let key = Utils.keyidToKey(keyid);\n            let key = row.getAttribute('data-row-id');\n            if (key === null) {\n                Log.error(`KEY ${key} BAD FORMAT should be TABLE-ID-FIELD-CMID`);\n            } else {\n                let source = Utils.domQuery(Selectors.sourcetexts.singlelang, '', row);\n                // Let multilang = Utils.domQuery(Selectors.sourcetexts.multilangs, keyid);\n                let multilang = Utils.domQuery(Selectors.sourcetexts.multilangs, ',', row);\n                source.classList.toggle(\"show\");\n                multilang.classList.toggle(\"show\");\n            }\n        };\n        const onGlossaryDbAllfailed = (obj)=> {\n            Log.info('onGlossaryDbAllfailed');\n            Log.error(obj);\n        };\n\n        const onGlossaryDbfailed = (obj)=> {\n            Log.info('onGlossaryDbfailed');\n            Log.error(obj);\n        };\n\n        const onGlossaryDbSuccess = (obj)=> {\n            Log.info('onGlossaryDbSuccess');\n            Log.info(obj);\n        };\n        /**\n         * Displays success message and icon.\n         *\n         * @param {String} key\n         * @param {string} savedText\n         */\n        const onSuccessMessageItem = (key, savedText) => {\n            Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key)\n                .classList.add(\"local_deepler__success\");\n            // Add saved indicator.\n            UI.setIconStatus(key, Selectors.statuses.success, Translation.translated(key));\n            // Replace text in the multilang textarea.\n            const multilangTextarea = Utils.domQuery(Selectors.editors.multiples.textAreas, key);\n            multilangTextarea.innerHTML = savedText;\n            // Deselect the checkbox.\n            Utils.domQuery(Selectors.editors.multiples.checkBoxesWithKey, key).checked = false;\n            // Remove success message after a few seconds.\n            setTimeout(() => {\n                let multilangPill = Utils.domQuery(Selectors.statuses.multilang, key);\n                let prevTransStatus = Utils.domQuery(Selectors.statuses.prevTransStatus, key);\n                prevTransStatus.classList = \"badge badge-pill badge-success\";\n                if (multilangPill.classList.contains(\"disabled\")) {\n                    multilangPill.classList.remove('disabled');\n                }\n                UI.setIconStatus(key, Selectors.statuses.saved, Translation.translated(key));\n            });\n        };\n        /**\n         * @returns void\n         */\n        const saveTranslations = () => {\n            const selectedCheckboxes = Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes);\n            if (selectedCheckboxes.length === 0) {\n                return;\n            }\n            // Prepare the UI for the save process.\n            UI.disableSaveButton();\n            UI.launchSaveAllModal();\n            // Prepare the data to be saved.\n            const data = [];\n            const keys = Array.from(selectedCheckboxes).map((e) => e.dataset.key);\n            keys.forEach((key) => {\n                    // @todo MDL-0000: should not rely on UI (add a flag in temptranslations object) .\n                    if (UI.getIconStatus(key) === Selectors.statuses.tosave) {\n                        UI.hideErrorMessage(key);\n                        const dbItem = Utils.prepareDBitem(key, Selectors.editors.multiples.editorsWithKey, config.courseid);\n                        data.push(dbItem);\n                    }\n                }\n            );\n            Translation.saveTranslations(data, config.userPrefs === 'textarea');\n        };\n    /**\n     * Saving a single translation to DB.\n     * @param {Event} e\n     */\n    const saveSingleTranslation = (e)=> {\n        const key = e.target.closest(Selectors.actions.validatorsBtns).dataset.keyValidator;\n        if (UI.getIconStatus(key) === Selectors.statuses.tosave) {\n            UI.hideErrorMessage(key);\n            const dbItem = Utils.prepareDBitem(key, Selectors.editors.multiples.editorsWithKey, config.courseid);\n            Translation.saveTranslations([dbItem], config.userPrefs === 'textarea');\n        }\n    };\n    /**\n     * Init.\n     *\n     * @param {object} cfg\n     */\n    const init = (cfg) => {\n        config = cfg;\n        registerEventListeners();\n    };\n    return {\n        init: init\n    };\n});\n"],"names":["define","Log","Utils","Translation","Api","Events","Selectors","UI","Settings","filterTimeout","config","handleFocusEvent","e","target","closest","editors","targetarea","wrapTinyOnTarget","handleClickEvent","actions","toggleMultilang","onToggleMultilang","autoTranslateBtn","callDeeplServices","selectAllBtn","toggleAllCheckboxes","checked","tothetop","backToBase","checkBoxes","toggleAutotranslateButton","saveAll","saveTranslations","validatorsBtns","saveSingleTranslation","glossary","entriesviewerPage","info","getValue","deepl","glossaryId","getGlossariesEntries","deeplsourcelang","targetlang","handleChangeEvent","hideiframes","doHideiframes","targetSwitcher","switchLocation","key","value","replace","rephrasesymbol","sectionSwitcher","moduleSwitcher","onItemChecked","sourceselect","onSourceChange","toggleGlossaryDetails","clearTimeout","setTimeout","showUpdated","debouncedShowRows","showNeedUpdate","showHidden","launchTranslatingModal","keys","cookie","settings","prepareSettingsAndCookieValues","disableSaveButton","domQueryAll","statuses","checkedCheckBoxes","forEach","ckBox","getAttribute","sourceText","domQuery","sourcetexts","singlelangkeys","editor","findEditor","initTempForKey","sourcelangdd","push","newCookiename","COOKIE_PREFIX_NEW","currentlang","courseid","setEncodedCookie","JSON","stringify","cookieduration","callTranslations","onTranslationFailed","error","disableTranslateButton","onTranslationDone","deeplErrorModal","enableSaveButton","hideModal","onItemTranslated","setIconStatus","tosave","onErrorMessageItem","warn","multiples","editorsWithKey","classList","add","failed","showErrorMessageForEditor","toggleStatus","translated","countWordAndChar","onDBFailed","status","dbErrorModal","onDbSavedSuccess","errors","length","dbErrorPartialModal","window","console","log","row","corerowid","source","singlelang","multilang","multilangs","toggle","onGlossaryDbAllfailed","obj","onGlossaryDbfailed","onGlossaryDbSuccess","onSuccessMessageItem","savedText","success","textAreas","innerHTML","checkBoxesWithKey","multilangPill","prevTransStatus","contains","remove","saved","selectedCheckboxes","launchSaveAllModal","data","Array","from","map","dataset","getIconStatus","hideErrorMessage","dbItem","prepareDBitem","userPrefs","keyValidator","init","cfg","document","addEventListener","on","ON_ITEM_TRANSLATED","ON_TRANSLATION_FAILED","ON_TRANSLATION_DONE","ON_REPHRASE_FAILED","ON_DB_SAVE_SUCCESS","ON_DB_FAILED","ON_ITEM_SAVED","ON_ITEM_NOT_SAVED","GLOSSARY_DB_ALL_FAILED","GLOSSARY_DB_FAILED","GLOSSARY_DB_SUCCESS","GLOSSARY_ENTRIES_SUCCESS","showEntriesModal","GLOSSARY_ENTRIES_FAILED"],"mappings":";;;;;;;AAsBAA,2CAAO,CACC,WACA,UACA,gBACA,QACA,iBACA,cACA,cACA,eAEJ,CACCC,IACAC,MACAC,YACAC,IACAC,OACAC,UACAC,GACAC,gBAGOC,cADAC,OAAS,SA+BPC,iBAAoBC,IAClBA,EAAEC,OAAOC,QAAQR,UAAUS,QAAQC,aAInCT,GAAGU,iBAAiBL,EAAEC,SAQxBK,iBAAoBN,IAClBA,EAAEC,OAAOC,QAAQR,UAAUa,QAAQC,kBACnCC,kBAAkBT,GAElBA,EAAEC,OAAOC,QAAQR,UAAUa,QAAQG,mBACnCC,oBAEAX,EAAEC,OAAOC,QAAQR,UAAUa,QAAQK,eAEnCjB,GAAGkB,oBAAoBb,EAAEC,OAAOa,SAEhCd,EAAEC,OAAOC,QAAQR,UAAUa,QAAQQ,WACnCpB,GAAGqB,aAEHhB,EAAEC,OAAOC,QAAQR,UAAUa,QAAQU,aACnCtB,GAAGuB,4BAEHlB,EAAEC,OAAOC,QAAQR,UAAUa,QAAQY,UACnCC,mBAEApB,EAAEC,OAAOC,QAAQR,UAAUa,QAAQc,iBACnCC,sBAAsBtB,GAEtBA,EAAEC,OAAOC,QAAQR,UAAU6B,SAASC,qBACpCnC,IAAIoC,KAAK,SACTpC,IAAIoC,KAAK7B,SAAS8B,SAAShC,UAAUiC,MAAMC,aAC3CpC,IAAIqC,qBACAjC,SAAS8B,SAAShC,UAAUiC,MAAMC,YAClC9B,OAAOgC,gBACPhC,OAAOiC,cAQbC,kBAAqBhC,IACnBA,EAAEC,OAAOC,QAAQR,UAAUa,QAAQ0B,cACnCtC,GAAGuC,gBAEHlC,EAAEC,OAAOC,QAAQR,UAAUa,QAAQ4B,iBAEnC7C,MAAM8C,eACF,CACIC,IAAK,cACLC,MAAOtC,EAAEC,OAAOqC,MAAMC,QAAQzC,OAAO0C,eAAgB,MAI7DxC,EAAEC,OAAOC,QAAQR,UAAUa,QAAQkC,kBAEnCnD,MAAM8C,eACF,CACIC,IAAK,aACLC,MAAOtC,EAAEC,OAAOqC,OACjB,eAGPtC,EAAEC,OAAOC,QAAQR,UAAUa,QAAQmC,iBAEnCpD,MAAM8C,eACF,CACIC,IAAK,cACLC,MAAOtC,EAAEC,OAAOqC,QAaxBtC,EAAEC,OAAOC,QAAQR,UAAUa,QAAQU,aACnC0B,cAAc3C,GAEdA,EAAEC,OAAOC,QAAQR,UAAUa,QAAQqC,eACnCC,eAAe7C,GAEfA,EAAEC,OAAOC,QAAQR,UAAUiC,MAAMC,aACjCjC,GAAGmD,sBAAsBlD,SAAS8B,SAAShC,UAAUiC,MAAMC,aAE/DmB,aAAalD,eACbA,cAAgBmD,YAAW,KACnBhD,EAAEC,OAAOC,QAAQR,UAAUa,QAAQ0C,cACnCtD,GAAGuD,oBAEHlD,EAAEC,OAAOC,QAAQR,UAAUa,QAAQ4C,iBACnCxD,GAAGuD,oBAEHlD,EAAEC,OAAOC,QAAQR,UAAUa,QAAQ6C,aACnCzD,GAAGuD,sBAEJ,KAKLvC,kBAAoB,KACtBhB,GAAG0D,+BACGC,KAAO,IACNC,OAAQC,UAAY5D,SAAS6D,iCAEpC9D,GAAG+D,oBACHpE,MAAMqE,YAAYjE,UAAUkE,SAASC,mBAChCC,SAASC,cACA1B,IAAM0B,MAAMC,aAAa,YACzBC,WAAa3E,MAAM4E,SAASxE,UAAUyE,YAAYC,eAAgB/B,KAClEgC,OAAS1E,GAAG2E,WAAWjC,KAC7B9C,YAAYgF,eACRlC,IAAKgC,OACLJ,WAAWD,aAAa,uBACxBC,WAAWD,aAAa,sBACxB1E,MAAM4E,SAASxE,UAAUyE,YAAYK,aAAcnC,KAAKC,OAE5DgB,KAAKmB,KAAKpC,cAEZqC,cAAgBpF,MAAMqF,kBAAoB7E,OAAO8E,YAAc9E,OAAOiC,WAAajC,OAAO+E,SAChGvF,MAAMwF,iBAAiBJ,cAAeK,KAAKC,UAAUzB,QAASzD,OAAOmF,gBACrE1F,YAAY2F,iBAAiB5B,KAAMxD,OAAQ0D,WAMzC2B,oBAAuBC,QACzBzF,GAAG0F,yBACHC,oBACA3F,GAAG4F,gBAAgBH,QAKjBE,kBAAoB,KAEtB3F,GAAG0F,yBACH1F,GAAG6F,mBACH7F,GAAG8F,aAODC,iBAAoBrD,MAEtB1C,GAAGgG,cAActD,IAAK3C,UAAUkE,SAASgC,QAAQ,IAQ/CC,mBAAqB,CAACxD,IAAK+C,SAC7B/F,IAAIyG,4BACJzG,IAAIyG,KAAKzD,KACThD,IAAIyG,KAAKV,OACM9F,MAAM4E,SAASxE,UAAUS,QAAQ4F,UAAUC,eAAgB3D,KACnE4D,UAAUC,IAAI,wBACrBvG,GAAGgG,cAActD,IAAK3C,UAAUkE,SAASuC,QACzCxG,GAAGyG,0BAA0B/D,IAAK+C,QAQhCvC,eAAkB7C,IAEpBX,IAAIoC,KAAK,kBACTpC,IAAIoC,KAAKzB,EAAEC,OAAO+D,aAAa,cAM7BrB,cAAiB3C,OAE0B,2BAAzCA,EAAEC,OAAO+D,aAAa,eAA6C,OAC7D3B,IAAMrC,EAAEC,OAAO+D,aAAa,YAClCrE,GAAG0G,aAAahE,IAAKrC,EAAEC,OAAOa,QAASvB,YAAY+G,WAAWjE,MAC9D1C,GAAG4G,qBASLC,WAAa,CAACpB,MAAOqB,UACvB9G,GAAG8F,YACH9F,GAAG+G,aAAatB,MAAOqB,SAMrBE,iBAAoBC,SACtBjH,GAAG8F,YACCmB,OAAOC,OAAS,GAChBlH,GAAGmH,oBAAoBF,OAAOC,SAShCpG,kBAAqBT,IACvB+G,OAAOC,QAAQC,IAAIjH,SACbkH,IAAMlH,EAAEC,OAAOC,QAAQR,UAAUa,QAAQ4G,eAG3C9E,IAAM6E,IAAIlD,aAAa,kBACf,OAAR3B,IACAhD,IAAI+F,oBAAa/C,sDACd,KACC+E,OAAS9H,MAAM4E,SAASxE,UAAUyE,YAAYkD,WAAY,GAAIH,KAE9DI,UAAYhI,MAAM4E,SAASxE,UAAUyE,YAAYoD,WAAY,IAAKL,KACtEE,OAAOnB,UAAUuB,OAAO,QACxBF,UAAUrB,UAAUuB,OAAO,UAG7BC,sBAAyBC,MAC3BrI,IAAIoC,KAAK,yBACTpC,IAAI+F,MAAMsC,MAGRC,mBAAsBD,MACxBrI,IAAIoC,KAAK,sBACTpC,IAAI+F,MAAMsC,MAGRE,oBAAuBF,MACzBrI,IAAIoC,KAAK,uBACTpC,IAAIoC,KAAKiG,MAQPG,qBAAuB,CAACxF,IAAKyF,aAC/BxI,MAAM4E,SAASxE,UAAUS,QAAQ4F,UAAUC,eAAgB3D,KACtD4D,UAAUC,IAAI,0BAEnBvG,GAAGgG,cAActD,IAAK3C,UAAUkE,SAASmE,QAASxI,YAAY+G,WAAWjE,MAE/C/C,MAAM4E,SAASxE,UAAUS,QAAQ4F,UAAUiC,UAAW3F,KAC9D4F,UAAYH,UAE9BxI,MAAM4E,SAASxE,UAAUS,QAAQ4F,UAAUmC,kBAAmB7F,KAAKvB,SAAU,EAE7EkC,YAAW,SACHmF,cAAgB7I,MAAM4E,SAASxE,UAAUkE,SAAS0D,UAAWjF,KAC3C/C,MAAM4E,SAASxE,UAAUkE,SAASwE,gBAAiB/F,KACzD4D,UAAY,iCACxBkC,cAAclC,UAAUoC,SAAS,aACjCF,cAAclC,UAAUqC,OAAO,YAEnC3I,GAAGgG,cAActD,IAAK3C,UAAUkE,SAAS2E,MAAOhJ,YAAY+G,WAAWjE,UAMzEjB,iBAAmB,WACfoH,mBAAqBlJ,MAAMqE,YAAYjE,UAAUkE,SAASC,sBAC9B,IAA9B2E,mBAAmB3B,cAIvBlH,GAAG+D,oBACH/D,GAAG8I,2BAEGC,KAAO,GACAC,MAAMC,KAAKJ,oBAAoBK,KAAK7I,GAAMA,EAAE8I,QAAQzG,MAC5DyB,SAASzB,SAEF1C,GAAGoJ,cAAc1G,OAAS3C,UAAUkE,SAASgC,OAAQ,CACrDjG,GAAGqJ,iBAAiB3G,WACd4G,OAAS3J,MAAM4J,cAAc7G,IAAK3C,UAAUS,QAAQ4F,UAAUC,eAAgBlG,OAAO+E,UAC3F6D,KAAKjE,KAAKwE,YAItB1J,YAAY6B,iBAAiBsH,KAA2B,aAArB5I,OAAOqJ,YAM5C7H,sBAAyBtB,UACrBqC,IAAMrC,EAAEC,OAAOC,QAAQR,UAAUa,QAAQc,gBAAgByH,QAAQM,gBACnEzJ,GAAGoJ,cAAc1G,OAAS3C,UAAUkE,SAASgC,OAAQ,CACrDjG,GAAGqJ,iBAAiB3G,WACd4G,OAAS3J,MAAM4J,cAAc7G,IAAK3C,UAAUS,QAAQ4F,UAAUC,eAAgBlG,OAAO+E,UAC3FtF,YAAY6B,iBAAiB,CAAC6H,QAA8B,aAArBnJ,OAAOqJ,mBAY/C,CACHE,KALUC,MACVxJ,OAASwJ,IAlWLC,SAASC,iBAAiB,SAAUxH,mBACpCuH,SAASC,iBAAiB,QAASlJ,kBACnCiJ,SAASC,iBAAiB,UAAWzJ,kBAGrCN,OAAOgK,GAAGlK,YAAYmK,mBAAoBhE,kBAC1CjG,OAAOgK,GAAGlK,YAAYoK,sBAAuBxE,qBAC7C1F,OAAOgK,GAAGlK,YAAYqK,oBAAqBtE,mBAC3C7F,OAAOgK,GAAGlK,YAAYsK,mBAAoB1E,qBAC1C1F,OAAOgK,GAAGlK,YAAYuK,mBAAoBnD,kBAC1ClH,OAAOgK,GAAGlK,YAAYwK,aAAcvD,YACpC/G,OAAOgK,GAAGlK,YAAYyK,cAAenC,sBACrCpI,OAAOgK,GAAGlK,YAAY0K,kBAAmBpE,oBAEzCpG,OAAOgK,GAAGjK,IAAI0K,uBAAwBzC,uBACtChI,OAAOgK,GAAGjK,IAAI2K,mBAAoBxC,oBAClClI,OAAOgK,GAAGjK,IAAI4K,oBAAqBxC,qBACnCnI,OAAOgK,GAAGjK,IAAI6K,yBAA0B1K,GAAG2K,kBAC3C7K,OAAOgK,GAAGjK,IAAI+K,yBAA0BvK,GAAIX,IAAI+F,MAAMpF"}