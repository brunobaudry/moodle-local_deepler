{"version":3,"file":"eventHandlers.min.js","sources":["../../src/local/eventHandlers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  description here.\n *\n * @module     'local_deepler'; // Full name of the plugin (used for diagnostics)./local/eventHandlers\n * @copyright  2025 Bruno Baudry <bruno.baudry@bfh.ch>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n        'core/log',\n        './utils',\n        './translation',\n        './api',\n        './customevents',\n        './selectors',\n        './uiHelpers',\n        './settings'\n    ],\n    (\n     Log,\n     Utils,\n     Translation,\n     Api,\n     Events,\n     Selectors,\n     UI,\n     Settings\n    )=>{\n        let config = {};\n        let filterTimeout;\n        /**\n         * Event factories.\n         */\n        const registerEventListeners = () => {\n            document.addEventListener('change', handleChangeEvent);\n            document.addEventListener('click', handleClickEvent);\n            document.addEventListener('focusin', handleFocusEvent);\n\n            // Translation events.\n            Events.on(Translation.ON_ITEM_TRANSLATED, onItemTranslated);\n            Events.on(Translation.ON_TRANSLATION_FAILED, onTranslationFailed);\n            Events.on(Translation.ON_TRANSLATION_DONE, onTranslationDone);\n            Events.on(Translation.ON_REPHRASE_FAILED, onTranslationFailed);\n            Events.on(Translation.ON_DB_SAVE_SUCCESS, onDbSavedSuccess);\n            Events.on(Translation.ON_DB_FAILED, onDBFailed);\n            Events.on(Translation.ON_ITEM_SAVED, onSuccessMessageItem);\n            Events.on(Translation.ON_ITEM_NOT_SAVED, onErrorMessageItem);\n            // Events.on(UI.ON_STATUS_CHANGED, onIconStatusChanged);\n            Events.on(Api.GLOSSARY_DB_ALL_FAILED, onGlossaryDbAllfailed);\n            Events.on(Api.GLOSSARY_DB_FAILED, onGlossaryDbfailed);\n            Events.on(Api.GLOSSARY_DB_SUCCESS, onGlossaryDbSuccess);\n            Events.on(Api.GLOSSARY_ENTRIES_SUCCESS, UI.showEntriesModal);\n            Events.on(Api.GLOSSARY_ENTRIES_FAILED, (e)=>Log.error(e));\n        };\n        /**\n         * Focus.\n         *\n         * @param {event} e\n         */\n        const handleFocusEvent = (e)=>{\n            if (e.target.closest(Selectors.editors.targetarea)) {\n                window.console.group('handleFocusEvent');\n                window.console.log(e, e.target);\n                window.console.groupEnd();\n                // UI.wrapTinyOnTarget(e.target);\n            }\n        };\n        /**\n         * Event listener for click events.\n         *\n         * @param {event} e\n         */\n        const handleClickEvent = (e) => {\n            if (e.target.closest(Selectors.actions.toggleMultilang)) {\n                onToggleMultilang(e.target.closest(Selectors.actions.toggleMultilang));\n            }\n            if (e.target.closest(Selectors.actions.autoTranslateBtn)) {\n                callDeeplServices();\n            }\n            if (e.target.closest(Selectors.actions.selectAllBtn)) {\n                // Here.\n                UI.toggleAllCheckboxes(e.target.checked);\n            }\n            if (e.target.closest(Selectors.actions.tothetop)) {\n                UI.backToBase();\n            }\n            if (e.target.closest(Selectors.actions.checkBoxes)) {\n                UI.toggleAutotranslateButton();\n            }\n            if (e.target.closest(Selectors.actions.saveAll)) {\n                saveTranslations();\n            }\n            if (e.target.closest(Selectors.actions.validatorsBtns)) {\n                saveSingleTranslation(e);\n            }\n            if (e.target.closest(Selectors.glossary.entriesviewerPage)) {\n                Log.info('CLICK');\n                Log.info(Settings.getValue(Selectors.deepl.glossaryId));\n                Api.getGlossariesEntries(\n                    Settings.getValue(Selectors.deepl.glossaryId),\n                    config.deeplsourcelang,\n                    config.targetlang\n                );\n            }\n        };\n        /**\n         * Event listener for change events.\n         * @param {event} e\n         */\n        const handleChangeEvent = (e) => {\n            if (e.target.closest(Selectors.actions.hideiframes)) {\n                UI.doHideiframes();\n            }\n            if (e.target.closest(Selectors.actions.targetSwitcher)) {\n                // SwitchTarget(e);\n                Utils.switchLocation(\n                    {\n                        key: 'target_lang',\n                        value: e.target.value.replace(config.rephrasesymbol, ''),\n                    }\n                );\n            }\n            if (e.target.closest(Selectors.actions.sectionSwitcher)) {\n                // SwitchSection(e);\n                Utils.switchLocation(\n                    {\n                        key: 'section_id',\n                        value: e.target.value,\n                    }, 'activity_id'\n                );\n            }\n            if (e.target.closest(Selectors.actions.moduleSwitcher)) {\n                // SwitchModules(e);\n                Utils.switchLocation(\n                    {\n                        key: 'activity_id',\n                        value: e.target.value,\n                    }\n                );\n            }\n/*            If (e.target.closest(Selectors.actions.sourceSwitcher)) {\n                // SwitchSource(e);\n                Utils.switchLocation(\n                    {\n                        key: 'lang',\n                        value: e.target.value,\n                    }\n                );\n            }*/\n            if (e.target.closest(Selectors.actions.checkBoxes)) {\n                onItemChecked(e);\n            }\n            if (e.target.closest(Selectors.actions.sourceselect)) {\n                onSourceChange(e);\n            }\n            if (e.target.closest(Selectors.deepl.glossaryId)) {\n                UI.toggleGlossaryDetails(Settings.getValue(Selectors.deepl.glossaryId));\n            }\n            clearTimeout(filterTimeout);\n            filterTimeout = setTimeout(() => {\n                if (e.target.closest(Selectors.actions.showUpdated)) {\n                    UI.debouncedShowRows();\n                }\n                if (e.target.closest(Selectors.actions.showNeedUpdate)) {\n                    UI.debouncedShowRows();\n                }\n                if (e.target.closest(Selectors.actions.showHidden)) {\n                    UI.debouncedShowRows();\n                }\n                }, 30);\n        };\n        /**\n         * Launch deepl services.\n         */\n        const callDeeplServices = () => {\n            UI.launchTranslatingModal();\n            const keys = [];\n            const [cookie, settings] = Settings.prepareSettingsAndCookieValues();\n            // UI.saveAllBtn.disabled = false;\n            UI.disableSaveButton();\n            Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes)\n                .forEach((ckBox) => {\n                    const key = ckBox.getAttribute(\"data-key\");\n                    const sourceText = Utils.domQuery(Selectors.sourcetexts.keys, key);\n                    const editor = UI.findEditor(key);\n                    Translation.initTempForKey(\n                        key, editor,\n                        sourceText.getAttribute(\"data-sourcetext-raw\"),\n                        sourceText.getAttribute(\"data-filedtext-raw\"),\n                        Utils.domQuery(Selectors.sourcetexts.sourcelangdd, key).value\n                    );\n                    keys.push(key);\n                });\n            const newCookiename = Utils.COOKIE_PREFIX_NEW + config.currentlang + config.targetlang + config.courseid;\n            Utils.setEncodedCookie(newCookiename, JSON.stringify(cookie), config.cookieduration);\n            Translation.callTranslations(keys, config, settings);\n        };\n        /**\n         * Event Listener when DeepL API call failed.\n         * @param {string} error\n         */\n        const onTranslationFailed = (error) => {\n            UI.disableTranslateButton();\n            onTranslationDone();\n            UI.deeplErrorModal(error);\n        };\n        /**\n         * Event Listener when DeepL API call finished.\n         */\n        const onTranslationDone = () => {\n            // UI.saveAllBtn.disabled = false;\n            UI.disableTranslateButton();\n            UI.enableSaveButton();\n            UI.hideModal();\n        };\n        /**\n         * Event listener for the translations process to dispaly the status.\n         *\n         * @param {string} key\n         */\n        const onItemTranslated = (key) => {\n            // Add saved indicator.\n            UI.setIconStatus(key, Selectors.statuses.tosave, true);\n        };\n        /**\n         * Displays error message and icon.\n         *\n         * @param {string} key\n         * @param {string} error\n         */\n        const onErrorMessageItem = (key, error) => {\n            Log.warn(`ui/errorMessageItem`);\n            Log.warn(key);\n            Log.warn(error);\n            const editor = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n            editor.classList.add(\"local_deepler__error\");\n            UI.setIconStatus(key, Selectors.statuses.failed);\n            UI.showErrorMessageForEditor(key, error);\n        };\n        /**\n         * Listener for individual source change.\n         * @todo MDL-000 implement in v1.4.0\n         *\n         * @param {event} e\n         */\n        const onSourceChange = (e) => {\n            // Do check source and target and propose rephrase if PRO.\n            Log.info('source changed');\n            Log.info(e.target.getAttribute('data-key'));\n        };\n        /**\n         * Event listener for selection checkboxes.\n         * @param {Event} e\n         */\n        const onItemChecked = (e) => {\n            // Check/uncheck checkboxes changes the charcount and icon status.\n            if (e.target.getAttribute('data-action') === \"local_deepler/checkbox\") {\n                const key = e.target.getAttribute('data-key');\n                UI.toggleStatus(key, e.target.checked, Translation.translated(key));\n                UI.countWordAndChar();\n            }\n        };\n        /**\n         * When a main error with the DB occurs.\n         *\n         * @param {string} error\n         * @param {int} status\n         */\n        const onDBFailed = (error, status) => {\n            UI.hideModal();\n            UI.dbErrorModal(error, status);\n        };\n        /**\n         *\n         * @param {array} errors\n         */\n        const onDbSavedSuccess = (errors) => {\n            UI.hideModal();\n            if (errors.length > 0) {\n                UI.dbErrorPartialModal(errors.length);\n            }\n        };\n\n        /**\n         * Multilang button handler\n         *\n         * @param {Event} e Event\n         */\n        const onToggleMultilang = (e) => {\n            let keyid = e.getAttribute('aria-controls');\n            let key = Utils.keyidToKey(keyid);\n            if (key === null) {\n                Log.error(`KEY ${keyid} BAD FORMAT should be TABLE-ID-FIELD-CMID`);\n            } else {\n                let source = Utils.domQuery(Selectors.sourcetexts.keys, key);\n                let multilang = Utils.domQuery(Selectors.sourcetexts.multilangs, keyid);\n                source.classList.toggle(\"show\");\n                multilang.classList.toggle(\"show\");\n            }\n        };\n        const onGlossaryDbAllfailed = (obj)=> {\n            Log.info('onGlossaryDbAllfailed');\n            Log.error(obj);\n        };\n\n        const onGlossaryDbfailed = (obj)=> {\n            Log.info('onGlossaryDbfailed');\n            Log.error(obj);\n        };\n\n        const onGlossaryDbSuccess = (obj)=> {\n            Log.info('onGlossaryDbSuccess');\n            Log.info(obj);\n        };\n        /**\n         * Displays success message and icon.\n         *\n         * @param {String} key\n         * @param {string} savedText\n         */\n        const onSuccessMessageItem = (key, savedText) => {\n            Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key)\n                .classList.add(\"local_deepler__success\");\n            // Add saved indicator.\n            UI.setIconStatus(key, Selectors.statuses.success, Translation.translated(key));\n            // Replace text in the multilang textarea.\n            const multilangTextarea = Utils.domQuery(Selectors.editors.multiples.textAreas, key);\n            multilangTextarea.innerHTML = savedText;\n            // Deselect the checkbox.\n            Utils.domQuery(Selectors.editors.multiples.checkBoxesWithKey, key).checked = false;\n            // Remove success message after a few seconds.\n            setTimeout(() => {\n                let multilangPill = Utils.domQuery(Selectors.statuses.multilang, key);\n                let prevTransStatus = Utils.domQuery(Selectors.statuses.prevTransStatus, key);\n                prevTransStatus.classList = \"badge badge-pill badge-success\";\n                if (multilangPill.classList.contains(\"disabled\")) {\n                    multilangPill.classList.remove('disabled');\n                }\n                UI.setIconStatus(key, Selectors.statuses.saved, Translation.translated(key));\n            });\n        };\n        /**\n         * @returns void\n         */\n        const saveTranslations = () => {\n            const selectedCheckboxes = Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes);\n            if (selectedCheckboxes.length === 0) {\n                return;\n            }\n            // Prepare the UI for the save process.\n            UI.disableSaveButton();\n            UI.launchSaveAllModal();\n            // Prepare the data to be saved.\n            const data = [];\n            const keys = Array.from(selectedCheckboxes).map((e) => e.dataset.key);\n            keys.forEach((key) => {\n                    // @todo MDL-0000: should not rely on UI (add a flag in temptranslations object) .\n                    if (UI.getIconStatus(key) === Selectors.statuses.tosave) {\n                        UI.hideErrorMessage(key);\n                        const dbItem = Utils.prepareDBitem(key, Selectors.editors.multiples.editorsWithKey, config.courseid);\n                        data.push(dbItem);\n                    }\n                }\n            );\n            Translation.saveTranslations(data, config.userPrefs === 'textarea');\n        };\n    /**\n     * Saving a single translation to DB.\n     * @param {Event} e\n     */\n    const saveSingleTranslation = (e)=> {\n        const key = e.target.closest(Selectors.actions.validatorsBtns).dataset.keyValidator;\n        if (UI.getIconStatus(key) === Selectors.statuses.tosave) {\n            UI.hideErrorMessage(key);\n            const dbItem = Utils.prepareDBitem(key, Selectors.editors.multiples.editorsWithKey, config.courseid);\n            Translation.saveTranslations([dbItem], config.userPrefs === 'textarea');\n        }\n    };\n    /**\n     * Init.\n     *\n     * @param {object} cfg\n     */\n    const init = (cfg) => {\n        config = cfg;\n        registerEventListeners();\n    };\n    return {\n        init: init\n    };\n});\n"],"names":["define","Log","Utils","Translation","Api","Events","Selectors","UI","Settings","filterTimeout","config","handleFocusEvent","e","target","closest","editors","targetarea","window","console","group","log","groupEnd","handleClickEvent","actions","toggleMultilang","onToggleMultilang","autoTranslateBtn","callDeeplServices","selectAllBtn","toggleAllCheckboxes","checked","tothetop","backToBase","checkBoxes","toggleAutotranslateButton","saveAll","saveTranslations","validatorsBtns","saveSingleTranslation","glossary","entriesviewerPage","info","getValue","deepl","glossaryId","getGlossariesEntries","deeplsourcelang","targetlang","handleChangeEvent","hideiframes","doHideiframes","targetSwitcher","switchLocation","key","value","replace","rephrasesymbol","sectionSwitcher","moduleSwitcher","onItemChecked","sourceselect","onSourceChange","toggleGlossaryDetails","clearTimeout","setTimeout","showUpdated","debouncedShowRows","showNeedUpdate","showHidden","launchTranslatingModal","keys","cookie","settings","prepareSettingsAndCookieValues","disableSaveButton","domQueryAll","statuses","checkedCheckBoxes","forEach","ckBox","getAttribute","sourceText","domQuery","sourcetexts","editor","findEditor","initTempForKey","sourcelangdd","push","newCookiename","COOKIE_PREFIX_NEW","currentlang","courseid","setEncodedCookie","JSON","stringify","cookieduration","callTranslations","onTranslationFailed","error","disableTranslateButton","onTranslationDone","deeplErrorModal","enableSaveButton","hideModal","onItemTranslated","setIconStatus","tosave","onErrorMessageItem","warn","multiples","editorsWithKey","classList","add","failed","showErrorMessageForEditor","toggleStatus","translated","countWordAndChar","onDBFailed","status","dbErrorModal","onDbSavedSuccess","errors","length","dbErrorPartialModal","keyid","keyidToKey","source","multilang","multilangs","toggle","onGlossaryDbAllfailed","obj","onGlossaryDbfailed","onGlossaryDbSuccess","onSuccessMessageItem","savedText","success","textAreas","innerHTML","checkBoxesWithKey","multilangPill","prevTransStatus","contains","remove","saved","selectedCheckboxes","launchSaveAllModal","data","Array","from","map","dataset","getIconStatus","hideErrorMessage","dbItem","prepareDBitem","userPrefs","keyValidator","init","cfg","document","addEventListener","on","ON_ITEM_TRANSLATED","ON_TRANSLATION_FAILED","ON_TRANSLATION_DONE","ON_REPHRASE_FAILED","ON_DB_SAVE_SUCCESS","ON_DB_FAILED","ON_ITEM_SAVED","ON_ITEM_NOT_SAVED","GLOSSARY_DB_ALL_FAILED","GLOSSARY_DB_FAILED","GLOSSARY_DB_SUCCESS","GLOSSARY_ENTRIES_SUCCESS","showEntriesModal","GLOSSARY_ENTRIES_FAILED"],"mappings":"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"}