{"version":3,"file":"eventHandlers.min.js","sources":["../../src/local/eventHandlers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  description here.\n *\n * @module     'local_deepler'; // Full name of the plugin (used for diagnostics)./local/eventHandlers\n * @copyright  2025 Bruno Baudry <bruno.baudry@bfh.ch>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n        'core/log',\n        './utils',\n        './translation',\n        './api',\n        './customevents',\n        './selectors',\n        './uiHelpers',\n        './settings'\n    ],\n    (\n     Log,\n     Utils,\n     Translation,\n     Api,\n     Events,\n     Selectors,\n     UI,\n     Settings\n    )=>{\n        let config = {};\n        let filterTimeout;\n    /**\n     * Event factories.\n     */\n    const registerEventListeners = () => {\n        document.addEventListener('change', handleChangeEvent);\n        document.addEventListener('click', handleClickEvent);\n        document.addEventListener('focusin', handleFocusEvent);\n\n        // Translation events.\n        Events.on(Translation.ON_ITEM_TRANSLATED, onItemTranslated);\n        Events.on(Translation.ON_TRANSLATION_FAILED, onTranslationFailed);\n        Events.on(Translation.ON_TRANSLATION_DONE, onTranslationDone);\n        Events.on(Translation.ON_REPHRASE_FAILED, onTranslationFailed);\n        Events.on(Translation.ON_DB_SAVE_SUCCESS, onDbSavedSuccess);\n        Events.on(Translation.ON_DB_FAILED, onDBFailed);\n        Events.on(Translation.ON_ITEM_SAVED, onSuccessMessageItem);\n        Events.on(Translation.ON_ITEM_NOT_SAVED, onErrorMessageItem);\n        Events.on(UI.ON_STATUS_CHANGED, onIconStatusChanged);\n        Events.on(Api.GLOSSARY_DB_ALL_FAILED, onGlossaryDbAllfailed);\n        Events.on(Api.GLOSSARY_DB_FAILED, onGlossaryDbfailed);\n        Events.on(Api.GLOSSARY_DB_SUCCESS, onGlossaryDbSuccess);\n        Events.on(Api.GLOSSARY_ENTRIES_SUCCESS, UI.showEntriesModal);\n        Events.on(Api.GLOSSARY_ENTRIES_FAILED, (e)=>Log.error(e));\n    };\n\n    const handleFocusEvent = (e)=>{\n        if (e.target.closest(Selectors.editors.targetarea)) {\n            UI.wrapTinyOnTarget(e.target);\n        }\n    };\n    /**\n     * Event listener for click events.\n     *\n     * @param {event} e\n     */\n    const handleClickEvent = (e) => {\n        if (e.target.closest(Selectors.actions.toggleMultilang)) {\n            onToggleMultilang(e.target.closest(Selectors.actions.toggleMultilang));\n        }\n        if (e.target.closest(Selectors.actions.autoTranslateBtn)) {\n            callDeeplServices();\n        }\n        if (e.target.closest(Selectors.actions.selectAllBtn)) {\n            // Here.\n            UI.toggleAllCheckboxes(e.target.checked);\n        }\n        if (e.target.closest(Selectors.actions.tothetop)) {\n            UI.backToBase();\n        }\n        if (e.target.closest(Selectors.actions.checkBoxes)) {\n            UI.toggleAutotranslateButton();\n        }\n        if (e.target.closest(Selectors.actions.saveAll)) {\n            saveTranslations();\n        }\n        if (e.target.closest(Selectors.actions.validatorsBtns)) {\n            saveSingleTranslation(e);\n        }\n        if (e.target.closest(Selectors.glossary.entriesviewerPage)) {\n            Log.info('CLICK');\n            Log.info(Settings.getValue(Selectors.deepl.glossaryId));\n            Api.getGlossariesEntries(\n                Settings.getValue(Selectors.deepl.glossaryId),\n                config.deeplsourcelang,\n                config.targetlang\n            );\n        }\n    };\n        /**\n         * Launch deepl services.\n         */\n        const callDeeplServices = () => {\n            UI.launchTranslatingModal();\n            const keys = [];\n            const [cookie, settings] = Settings.prepareSettingsAndCookieValues();\n            UI.saveAllBtn.disabled = false;\n            Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes)\n                .forEach((ckBox) => {\n                    const key = ckBox.getAttribute(\"data-key\");\n                    const sourceText = Utils.domQuery(Selectors.sourcetexts.keys, key);\n                    const editor = UI.findEditor(key);\n                    Translation.initTempForKey(\n                        key, editor,\n                        sourceText.getAttribute(\"data-sourcetext-raw\"),\n                        sourceText.getAttribute(\"data-filedtext-raw\"),\n                        Utils.domQuery(Selectors.sourcetexts.sourcelangdd, key).value\n                    );\n                    keys.push(key);\n                });\n            const newCookiename = Utils.COOKIE_PREFIX_NEW + config.currentlang + config.targetlang + config.courseid;\n            Utils.setEncodedCookie(newCookiename, JSON.stringify(cookie), config.cookieduration);\n            Translation.callTranslations(keys, config, settings);\n        };\n    /**\n     * Event listener for change events.\n     * @param {event} e\n     */\n    const handleChangeEvent = (e) => {\n        if (e.target.closest(Selectors.actions.hideiframes)) {\n            UI.doHideiframes();\n        }\n        if (e.target.closest(Selectors.actions.targetSwitcher)) {\n            // SwitchTarget(e);\n            Utils.switchLocation(\n                {\n                    key: 'target_lang',\n                    value: e.target.value.replace(config.rephrasesymbol, ''),\n                }\n            );\n        }\n        if (e.target.closest(Selectors.actions.sectionSwitcher)) {\n            // SwitchSection(e);\n            Utils.switchLocation(\n                {\n                    key: 'section_id',\n                    value: e.target.value,\n                }, 'activity_id'\n            );\n        }\n        if (e.target.closest(Selectors.actions.moduleSwitcher)) {\n            // SwitchModules(e);\n            Utils.switchLocation(\n                {\n                    key: 'activity_id',\n                    value: e.target.value,\n                }\n            );\n        }\n        if (e.target.closest(Selectors.actions.sourceSwitcher)) {\n            // SwitchSource(e);\n            Utils.switchLocation(\n                {\n                    key: 'lang',\n                    value: e.target.value,\n                }\n            );\n        }\n        if (e.target.closest(Selectors.actions.checkBoxes)) {\n            onItemChecked(e);\n        }\n        if (e.target.closest(Selectors.actions.sourceselect)) {\n            onSourceChange(e);\n        }\n        if (e.target.closest(Selectors.deepl.glossaryId)) {\n            UI.toggleGlossaryDetails(Settings.getValue(Selectors.deepl.glossaryId));\n        }\n        clearTimeout(filterTimeout);\n        filterTimeout = setTimeout(() => {\n            if (e.target.closest(Selectors.actions.showUpdated)) {\n                UI.debouncedShowRows();\n            }\n            if (e.target.closest(Selectors.actions.showNeedUpdate)) {\n                UI.debouncedShowRows();\n            }\n            if (e.target.closest(Selectors.actions.showHidden)) {\n                UI.debouncedShowRows();\n            }\n            }, 30);\n    };\n    const onIconStatusChanged = (key)=>{\n        // Reset the translation.\n        Translation.initTemp(key);\n    };\n    /**\n     * Event Listener when DeepL API call failed.\n     * @param {string} error\n     */\n    const onTranslationFailed = (error) => {\n        onTranslationDone();\n        UI.deeplErrorModal(error);\n    };\n    /**\n     * Event Listener when DeepL API call finished.\n     */\n    const onTranslationDone = () => {\n        UI.hideModal();\n    };\n    /**\n     * Event listener for the translations process to dispaly the status.\n     *\n     * @param {string} key\n     */\n    const onItemTranslated = (key) => {\n        // Add saved indicator.\n        UI.setIconStatus(key, Selectors.statuses.tosave, true);\n    };\n    /**\n     * Displays error message and icon.\n     *\n     * @param {string} key\n     * @param {string} error\n     */\n    const onErrorMessageItem = (key, error) => {\n        Log.warn(`ui/errorMessageItem`);\n        Log.warn(key);\n        Log.warn(error);\n        const editor = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n        editor.classList.add(\"local_deepler__error\");\n        UI.setIconStatus(key, Selectors.statuses.failed);\n        UI.showErrorMessageForEditor(key, error);\n    };\n    /**\n     * Listener for individual source change.\n     * @todo MDL-000 implement in v1.4.0\n     *\n     * @param {event} e\n     */\n    const onSourceChange = (e) => {\n        // Do check source and target and propose rephrase if PRO.\n        Log.info('source changed');\n        Log.info(e.target.getAttribute('data-key'));\n    };\n    /**\n     * Event listener for selection checkboxes.\n     * @param {Event} e\n     */\n    const onItemChecked = (e) => {\n        // Check/uncheck checkboxes changes the charcount and icon status.\n        if (e.target.getAttribute('data-action') === \"local_deepler/checkbox\") {\n            const key = e.target.getAttribute('data-key');\n            UI.toggleStatus(key, e.target.checked, Translation.translated(key));\n            UI.countWordAndChar();\n        }\n    };\n    /**\n     * When a main error with the DB occurs.\n     *\n     * @param {string} error\n     * @param {int} status\n     */\n    const onDBFailed = (error, status) => {\n        UI.hideModal();\n        UI.dbErrorModal(error, status);\n    };\n    /**\n     *\n     * @param {array} errors\n     */\n    const onDbSavedSuccess = (errors) => {\n        UI.hideModal();\n        if (errors.length > 0) {\n            UI.dbErrorPartialModal(errors.length);\n        }\n    };\n\n    /**\n     * Multilang button handler\n     *\n     * @param {Event} e Event\n     */\n    const onToggleMultilang = (e) => {\n        let keyid = e.getAttribute('aria-controls');\n        let key = Utils.keyidToKey(keyid);\n        if (key === null) {\n            Log.error(`KEY ${keyid} BAD FORMAT should be TABLE-ID-FIELD-CMID`);\n        } else {\n            let source = Utils.domQuery(Selectors.sourcetexts.keys, key);\n            let multilang = Utils.domQuery(Selectors.sourcetexts.multilangs, keyid);\n            source.classList.toggle(\"show\");\n            multilang.classList.toggle(\"show\");\n        }\n    };\n    const onGlossaryDbAllfailed = (obj)=> {\n        Log.info('onGlossaryDbAllfailed');\n        Log.error(obj);\n    };\n\n    const onGlossaryDbfailed = (obj)=> {\n        Log.info('onGlossaryDbfailed');\n        Log.error(obj);\n    };\n\n    const onGlossaryDbSuccess = (obj)=> {\n        Log.info('onGlossaryDbSuccess');\n        Log.info(obj);\n    };\n    /**\n     * Displays success message and icon.\n     *\n     * @param {String} key\n     * @param {string} savedText\n     */\n    const onSuccessMessageItem = (key, savedText) => {\n        Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key)\n            .classList.add(\"local_deepler__success\");\n        // Add saved indicator.\n        UI.setIconStatus(key, Selectors.statuses.success, Translation.translated(key));\n        // Replace text in the multilang textarea.\n        const multilangTextarea = Utils.domQuery(Selectors.editors.multiples.textAreas, key);\n        multilangTextarea.innerHTML = savedText;\n        // Deselect the checkbox.\n        Utils.domQuery(Selectors.editors.multiples.checkBoxesWithKey, key).checked = false;\n        // Remove success message after a few seconds.\n        setTimeout(() => {\n            let multilangPill = Utils.domQuery(Selectors.statuses.multilang, key);\n            let prevTransStatus = Utils.domQuery(Selectors.statuses.prevTransStatus, key);\n            prevTransStatus.classList = \"badge badge-pill badge-success\";\n            if (multilangPill.classList.contains(\"disabled\")) {\n                multilangPill.classList.remove('disabled');\n            }\n            UI.setIconStatus(key, Selectors.statuses.saved, Translation.translated(key));\n        });\n    };\n        /**\n         * @returns void\n         */\n        const saveTranslations = () => {\n            const selectedCheckboxes = Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes);\n            if (selectedCheckboxes.length === 0) {\n                return;\n            }\n            // Prepare the UI for the save process.\n            UI.saveAllBtn.disabled = true;\n            UI.launchSaveAllModal();\n/*            LaunchModal({\n                title: langstrings.uistrings.saveallmodaltitle,\n                body: langstrings.uistrings.saveallmodalbody,\n            }).then(r => Log.info('SaveAll Modal launched ' + r)).catch((reason)=>{\n                Log.error(reason);\n            });*/\n            // Prepare the data to be saved.\n            const data = [];\n            const keys = Array.from(selectedCheckboxes).map((e) => e.dataset.key);\n            keys.forEach((key) => {\n                    // @todo MDL-0000: should not rely on UI (add a flag in temptranslations object) .\n                    if (UI.getIconStatus(key) === Selectors.statuses.tosave) {\n                        UI.hideErrorMessage(key);\n                        const dbItem = Utils.prepareDBitem(key, Selectors.editors.multiples.editorsWithKey, config.courseid);\n                        data.push(dbItem);\n                    }\n                }\n            );\n            Translation.saveTranslations(data, config.userPrefs === 'textarea');\n        };\n    /**\n     * Saving a single translation to DB.\n     * @param {Event} e\n     */\n    const saveSingleTranslation = (e)=> {\n        const key = e.target.closest(Selectors.actions.validatorsBtns).dataset.keyValidator;\n        if (UI.getIconStatus(key) === Selectors.statuses.tosave) {\n            UI.hideErrorMessage(key);\n            const dbItem = Utils.prepareDBitem(key, Selectors.editors.multiples.editorsWithKey, config.courseid);\n            Translation.saveTranslations([dbItem], config.userPrefs === 'textarea');\n        }\n    };\n    const init = (cfg) => {\n        config = cfg;\n        registerEventListeners();\n    };\n    return {\n        init: init\n    };\n});\n"],"names":["define","Log","Utils","Translation","Api","Events","Selectors","UI","Settings","filterTimeout","config","handleFocusEvent","e","target","closest","editors","targetarea","wrapTinyOnTarget","handleClickEvent","actions","toggleMultilang","onToggleMultilang","autoTranslateBtn","callDeeplServices","selectAllBtn","toggleAllCheckboxes","checked","tothetop","backToBase","checkBoxes","toggleAutotranslateButton","saveAll","saveTranslations","validatorsBtns","saveSingleTranslation","glossary","entriesviewerPage","info","getValue","deepl","glossaryId","getGlossariesEntries","deeplsourcelang","targetlang","launchTranslatingModal","keys","cookie","settings","prepareSettingsAndCookieValues","saveAllBtn","disabled","domQueryAll","statuses","checkedCheckBoxes","forEach","ckBox","key","getAttribute","sourceText","domQuery","sourcetexts","editor","findEditor","initTempForKey","sourcelangdd","value","push","newCookiename","COOKIE_PREFIX_NEW","currentlang","courseid","setEncodedCookie","JSON","stringify","cookieduration","callTranslations","handleChangeEvent","hideiframes","doHideiframes","targetSwitcher","switchLocation","replace","rephrasesymbol","sectionSwitcher","moduleSwitcher","sourceSwitcher","onItemChecked","sourceselect","onSourceChange","toggleGlossaryDetails","clearTimeout","setTimeout","showUpdated","debouncedShowRows","showNeedUpdate","showHidden","onIconStatusChanged","initTemp","onTranslationFailed","error","onTranslationDone","deeplErrorModal","hideModal","onItemTranslated","setIconStatus","tosave","onErrorMessageItem","warn","multiples","editorsWithKey","classList","add","failed","showErrorMessageForEditor","toggleStatus","translated","countWordAndChar","onDBFailed","status","dbErrorModal","onDbSavedSuccess","errors","length","dbErrorPartialModal","keyid","keyidToKey","source","multilang","multilangs","toggle","onGlossaryDbAllfailed","obj","onGlossaryDbfailed","onGlossaryDbSuccess","onSuccessMessageItem","savedText","success","textAreas","innerHTML","checkBoxesWithKey","multilangPill","prevTransStatus","contains","remove","saved","selectedCheckboxes","launchSaveAllModal","data","Array","from","map","dataset","getIconStatus","hideErrorMessage","dbItem","prepareDBitem","userPrefs","keyValidator","init","cfg","document","addEventListener","on","ON_ITEM_TRANSLATED","ON_TRANSLATION_FAILED","ON_TRANSLATION_DONE","ON_REPHRASE_FAILED","ON_DB_SAVE_SUCCESS","ON_DB_FAILED","ON_ITEM_SAVED","ON_ITEM_NOT_SAVED","ON_STATUS_CHANGED","GLOSSARY_DB_ALL_FAILED","GLOSSARY_DB_FAILED","GLOSSARY_DB_SUCCESS","GLOSSARY_ENTRIES_SUCCESS","showEntriesModal","GLOSSARY_ENTRIES_FAILED"],"mappings":"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"}