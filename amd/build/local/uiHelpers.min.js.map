{"version":3,"file":"uiHelpers.min.js","sources":["../../src/local/uiHelpers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  description here.\n *\n * @module     'local_deepler'; // Full name of the plugin (used for diagnostics)./local/uiHelpers\n * @copyright  2025 Bruno Baudry <bruno.baudry@bfh.ch>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['core/modal',\n    'core/log',\n    'editor_tiny/loader',\n    'editor_tiny/editor',\n    './utils',\n    './selectors',\n    './customevents',\n    './translation'\n    ], (\n        Modal,\n        Log,\n        TinyMCEinit,\n        TinyMCE,\n        Utils,\n        Selectors,\n        Events,\n        Translation)=>{\n    // Let preloader;\n    let config = {};\n    let format = new Intl.NumberFormat();\n    let autotranslateButton = {};\n    let saveAllBtn = {};\n    let saveAllModal = {};\n    let langstrings = {};\n    let selectAllBtn = {};\n    let removedIframes = [];\n    let allDataFormatOne = [];\n    let checkboxes = [];\n    let glossaryDetailViewr;\n    let checkBoxParentMap = new Map();\n    const optionsForTiny = {\n        subdirs: false,\n        maxbytes: 10240,\n        maxfiles: 0,\n        noclean: true,\n        trusttext: true,\n        // eslint-disable-next-line camelcase\n        enable_filemanagement: false,\n        autosave: false,\n        removeorphaneddrafts: true,\n        plugins: []\n    };\n    const ON_STATUS_CHANGED = 'onStatusChanged';\n    // Cached DOM elements\n    const cachedSelectors = {\n        wordCount: document.querySelector(Selectors.statuses.wordcount),\n        charWithSpace: document.querySelector(Selectors.statuses.charNumWithSpace),\n        charWOSpace: document.querySelector(Selectors.statuses.charNumWithOutSpace),\n        deeplUseSpan: document.querySelector(Selectors.statuses.deeplUsage),\n        deeplMaxSpan: document.querySelector(Selectors.statuses.deeplMax),\n        deeplStatusContainer: document.querySelector(Selectors.statuses.deeplStatusContainer)\n    };\n    /**\n     * Toggle iFrames in sourcetexts.\n     */\n    function doHideiframes() {\n        const isChecked = Utils.domQuery(Selectors.actions.hideiframes);\n        const allIframes = Utils.domQueryAll(Selectors.sourcetexts.iframes);\n        if (!isChecked && allIframes.length > 0) {\n            removedIframes = [];\n            allIframes.forEach(iframe => {\n                removedIframes.push({\n                    parent: iframe.parentNode,\n                    nextSibling: iframe.nextSibling,\n                    html: iframe.outerHTML\n                });\n                iframe.remove();\n            });\n        } else if (removedIframes.length > 0) {\n            // Restore all previously removed iframes.\n            removedIframes.forEach(info => {\n                // Create a new element from the stored HTML.\n                const tempDiv = document.createElement('div');\n                tempDiv.innerHTML = info.html;\n                const newIframe = tempDiv.firstChild;\n                // Insert it back into the DOM\n                if (info.nextSibling) {\n                    info.parent.insertBefore(newIframe, info.nextSibling);\n                } else {\n                    info.parent.appendChild(newIframe);\n                }\n            });\n            removedIframes = [];\n        }\n    }\n    /**\n     * Get the editor container based on recieved current user's editor preference.\n     *\n     * @param {string} key Translation Key\n     */\n    const findEditor = (key) => {\n        let e = Utils.domQuery(Selectors.editors.types.basic, key);\n        let et = 'basic';\n        if (e === null) {\n            let r = null;\n            let editorTab = [\"atto\", \"tiny\", \"marklar\", \"textarea\"];\n            if (editorTab.indexOf(config.userPrefs) === -1) {\n                Log.warn('Unsupported editor ' + config.userPrefs);\n            } else {\n                // First let's try the current editor.\n                try {\n                    r = findEditorByType(key, config.userPrefs);\n                } catch (error) {\n                    // Content was edited by another editor.\n                    Log.trace(`Editor not found: ${config.userPrefs} for key ${key}`);\n                }\n            }\n            return r;\n        } else {\n            return {editor: e, editorType: et};\n        }\n    };\n    /**\n     * @param {string} key\n     * @param {object} editorType\n     * @returns {{editor: object, editorType: string}}\n     */\n    const findEditorByType = (key, editorType) => {\n        let et = 'basic';\n        let ed = null;\n        switch (editorType) {\n            case \"atto\" :\n                et = 'iframe';\n                ed = Utils.domQuery(Selectors.editors.types.atto, key);\n                break;\n            case \"tiny\":\n                et = 'iframe';\n                ed = findTinyInstanceByKey(key);\n                break;\n            case 'marklar':\n            case \"textarea\" :\n                ed = Utils.domQuery(Selectors.editors.types.other, key);\n                break;\n        }\n        return {editor: ed, editorType: et};\n    };\n    /**\n     * Finds TinyMCE instance.\n     * @param {string} key\n     * @returns {Node}\n     */\n    const findTinyInstanceByKey = (key)=> {\n        let editor = null;\n        TinyMCE.getAllInstances().every((k, v)=>{\n            if (v.attributes.name.value.indexOf(key) === 0) {\n                editor = k.getBody();\n                return false;\n            }\n            return true;\n        });\n        return editor;\n    };\n    /**\n     * Hides an item's error message.\n     *\n     * @param {String} key\n     */\n    const hideErrorMessage = (key) => {\n        let parent = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n        let alertChild = Utils.domQuery('.alert-danger', '', parent);\n        if (alertChild) {\n            parent.removeChild(alertChild);\n        }\n    };\n    /**\n     * Display an error message attached to the item's editor.\n     * @param {String} key\n     * @param {String} message\n     */\n    const showErrorMessageForEditor = (key, message) => {\n        let parent = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n        const errorMsg = document.createElement('div');\n        const indexOfSET = message.indexOf(\"Data too long\");// Probably a text too long for the field if not -1.\n        // Display granular error messages.\n        if (indexOfSET > -1) {\n            message = message.substring(0, message.indexOf('WHERE id=?'));\n            message = message + ' ' + langstrings.uistrings.errortoolong;\n        }\n        errorMsg.id = 'local_deepler__errormsg';\n        errorMsg.classList = ['alert alert-danger'];\n        errorMsg.innerHTML = message;\n        parent.appendChild(errorMsg);\n    };\n    const showEntriesModal = (ajaxResponse)=>{\n        const glossaryid = ajaxResponse.glossaryid;\n        const entries = JSON.parse(ajaxResponse.entries);\n        const status = ajaxResponse.status;\n        const message = ajaxResponse.message;\n        if (status === 'success') {\n            const table = document.createElement('table');\n            table.className = 'generaltable';\n            // Create the header.\n            const thead = document.createElement('thead');\n            thead.innerHTML = `<tr><th>${ajaxResponse.source.toUpperCase()}</th>\n                <th>${ajaxResponse.target.toUpperCase()}</th></tr>`;\n            table.appendChild(thead);\n\n            const tbody = document.createElement('tbody');\n\n            Object.entries(entries).forEach(([key, value]) => {\n                const row = document.createElement('tr');\n                row.innerHTML = `<td>${key}</td><td>${value}</td>`;\n                tbody.appendChild(row);\n            });\n\n            table.appendChild(tbody);\n\n            Modal.create({\n                title: 'Entries',\n                body: table,\n                type: 'default',\n                show: true,\n                removeOnClose: true,\n            });\n        } else {\n            Modal.create({\n                title: `Error fetching entries for<br/><em>${glossaryid}</em>`,\n                body: message,\n                type: 'default',\n                show: true,\n                removeOnClose: true,\n            });\n        }\n    };\n    /**\n     * Launch, display count of Words And Chars.\n     */\n    const countWordAndChar = () => {\n        let wrdsc = 0,\n            cws = 0,\n            cwos = 0;\n\n        // Cache checkboxes matching selector once, convert to array if needed.\n        const checkedBoxes = Array.from(Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes));\n\n        // Aggregate counts in one loop.\n        checkedBoxes.forEach(ckBox => {\n            const key = ckBox.getAttribute(\"data-key\");\n            const results = getCount(key);\n            wrdsc += results.wordCount;\n            cws += results.charNumWithSpace;\n            cwos += results.charNumWithOutSpace;\n        });\n\n        // Cache DOM elements once for output instead of querying repeatedly.\n        const wordCount = cachedSelectors.wordCount;\n        const charWithSpace = cachedSelectors.charWithSpace;\n        const charWOSpace = cachedSelectors.charWOSpace;\n        const deeplUseSpan = cachedSelectors.deeplUseSpan;\n        const deeplMaxSpan = cachedSelectors.deeplMaxSpan;\n        const parent = cachedSelectors.deeplStatusContainer;\n\n        // Calculate current usage once.\n        const current = cws + config.usage.character.count;\n\n        // Update UI in one batch (minimizes layout thrashing).\n        wordCount.innerText = wrdsc;\n        charWithSpace.innerText = cws;\n        charWOSpace.innerText = cwos;\n        deeplUseSpan.innerText = format.format(current);\n        deeplMaxSpan.innerText = config.usage.character.limit === null ? 'âˆž' : format.format(config.usage.character.limit);\n\n        // Toggle classes efficiently.\n        parent.classList.toggle('alert-success', current < config.usage.character.limit || config.usage.character.limit === null);\n        parent.classList.toggle('alert-danger', current >= config.usage.character.limit && config.usage.character.limit !== null);\n    };\n    /**\n     * Compile the needed counts for info.\n     *\n     * @param {string} key\n     * @returns {{wordCount: *, charNumWithSpace: *, charNumWithOutSpace: *}}\n     */\n    const getCount = (key) => {\n        const item = Utils.domQuery(Selectors.sourcetexts.singlelangkeys, key);\n        const raw = item.getAttribute(\"data-sourcetext-raw\");\n        // Cleaned sourceText.\n        const trimmedVal = Utils.stripHTMLTags(Utils.fromBase64(raw)).trim();\n        return {\n            \"wordCount\": (trimmedVal.match(/\\S+/g) || []).length,\n            \"charNumWithSpace\": trimmedVal.length,\n            \"charNumWithOutSpace\": trimmedVal.replace(/\\s+/g, '').length\n        };\n    };\n\n    /**\n     * Factory to display process' statuses for each item.\n     *\n     * @param {String} key\n     * @param {Boolean} checked\n     * @param {Boolean} translated\n     * @todo MDL-0000 optimize\n     */\n    const toggleStatus = (key, checked, translated) => {\n        const icon = Utils.domQuery(Selectors.actions.validatorBtn, key);\n        const status = icon?.dataset.status;\n        let disaptchStatus = Selectors.statuses.wait;\n\n        if (!status) {\n            return;\n        }\n\n        switch (status) {\n            case Selectors.statuses.wait:\n                // Events.emit(ON_STATUS_CHANGED, key );\n                if (checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                    disaptchStatus = Selectors.statuses.totranslate;\n                }\n                break;\n\n            case Selectors.statuses.totranslate:\n                if (checked && translated) {\n                    setIconElementStatus(icon, Selectors.statuses.tosave, true);\n                    disaptchStatus = Selectors.statuses.tosave;\n                } else {\n                    setIconElementStatus(icon, Selectors.statuses.wait);\n                }\n                break;\n\n            case Selectors.statuses.tosave:\n                if (!checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                    disaptchStatus = Selectors.statuses.totranslate;\n                }\n                break;\n\n            case Selectors.statuses.failed:\n                if (checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                    disaptchStatus = Selectors.statuses.totranslate;\n                }\n                break;\n\n            case Selectors.statuses.success:\n                disaptchStatus = Selectors.statuses.success;\n                break;\n\n            case Selectors.statuses.saved:\n                if (checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                    disaptchStatus = Selectors.statuses.totranslate;\n                }\n                break;\n        }\n        Events.emit(ON_STATUS_CHANGED, key, disaptchStatus);\n    };\n    /**\n     * Change translation process status icon.\n     *\n     * @param {element} icon\n     * @param {string} status\n     * @param {boolean} isBtn\n     * @todo MDL-0000 optimize\n     */\n    const setIconElementStatus = (icon, status = Selectors.statuses.wait, isBtn = false) => {\n        if (!icon) {\n         return;\n        }\n\n        const classList = icon.classList;\n\n        // Update classes only if needed\n        if (isBtn) {\n            if (!classList.contains('btn')) {\n                classList.add('btn', 'btn-outline-secondary');\n            }\n            if (classList.contains('disable')) {\n                classList.remove('disable');\n            }\n        } else {\n            if (!classList.contains('disable')) {\n                classList.add('disable');\n            }\n            if (classList.contains('btn')) {\n                classList.remove('btn', 'btn-outline-secondary');\n            }\n        }\n\n        // Update attributes only if changed\n        if (icon.getAttribute('role') !== (isBtn ? 'button' : 'status')) {\n            icon.setAttribute('role', isBtn ? 'button' : 'status');\n        }\n\n        if (icon.dataset.status !== status) {\n            icon.setAttribute('data-status', status);\n        }\n\n        const title = langstrings.statusstrings[status.replace('local_deepler/', '')];\n        if (icon.getAttribute('title') !== title) {\n            icon.setAttribute('title', title);\n        }\n    };\n\n\n    const setIconStatus = (key, status = Selectors.statuses.wait, isBtn = false) => {\n        let icon = Utils.domQuery(Selectors.actions.validatorBtn, key);\n        setIconElementStatus(icon, status, isBtn);\n    };\n    /**\n     * Get the translation row status icon.\n     *\n     * @param {string} key\n     * @returns {*}\n     */\n    const getIconStatus = (key)=> {\n        return Utils.domQuery(Selectors.actions.validatorBtn, key).getAttribute('data-status');\n    };\n    /**\n     * Opens a modal infobox to warn user trunks of fields are saving.\n     * @param {object} messageObject\n     * @returns {Promise<void>}\n     */\n    const launchModal = async(messageObject) => {\n        saveAllModal = await Modal.create(messageObject);\n        await saveAllModal.show();\n    };\n    const launchTranslatingModal = ()=>{\n        return launchModal(\n            {\n                title: langstrings.uistrings.translatemodaltitle,\n                body: langstrings.uistrings.translatemodalbody,\n            }\n        );\n    };\n    const launchSaveAllModal = ()=>{\n        launchModal(\n            {\n                title: langstrings.uistrings.saveallmodaltitle,\n                body: langstrings.uistrings.saveallmodalbody,\n            }\n        ).then(r => Log.info('SaveAll Modal launched ' + r)).catch((reason)=>{\n            Log.error(reason);\n        });\n    };\n    const dbErrorPartialModal = (stringVar)=>{\n        const body = langstrings.uistrings.errordbpartial.replace('{$a}', stringVar);\n        dbErrorModal(body);\n    };\n    const dbErrorModal = (body, titleSuffix = '')=>{\n        let title = langstrings.uistrings.errordbtitle;\n        if (titleSuffix !== '') {\n            title += titleSuffix;\n        }\n        presentDialogModal(title, body, 'alert');\n    };\n    const deeplErrorModal = (body)=>{\n        presentDialogModal(langstrings.uistrings.deeplapiexception, body, 'Alert');\n    };\n    const presentDialogModal = (title, body, type = 'default') => {\n        Modal.create({\n            title: title,\n            body: body,\n            type: type,\n            show: true,\n            removeOnClose: true,\n        });\n    };\n\n    const hideModal = ()=>{\n        if (saveAllModal !== null && saveAllModal.isVisible) {\n            saveAllModal.hide();\n        }\n    };\n    const backToBase = () => {\n        const offsetTop = Utils.domQuery(Selectors.config.langstrings).offsetTop;\n        window.scrollTo({top: offsetTop - 5, behavior: 'smooth'});\n    };\n\n    const resizeEditors = ()=>{\n        allDataFormatOne.forEach((editable)=>{\n            // Window.console.log(editable, editable.closest('[data-row-id]'));\n            // Const key = editable.id.replace('tiny_', '');\n            // Const selector = `[data-sourcetext-key=\"${key}\"]`;\n            const grandparent = editable.closest('[data-row-id]');\n            const sourceTextSinglelang = Utils.domQuery(Selectors.sourcetexts.singlelang, '', grandparent);\n            // Const sourceTextMultilang = Utils.domQuery(Selectors.sourcetexts.multilangs, '', grandparent);\n\n            // Const grandparent1 = parent.parentElement;\n\n\n             const updateEditableHeight = ()=> {\n                 // eslint-disable-next-line max-len\n                 // Const offsetElement = sourceTextMultilang.classList.contains('show') ? sourceTextMultilang : sourceTextSinglelang;\n\n                 window.console.log(editable, grandparent?.offsetHeight, sourceTextSinglelang?.offsetHeight);\n               const totalHeight = sourceTextSinglelang.offsetHeight + 80; // Tiny header average height is 80.\n                editable.style.height = totalHeight + 'px';\n            };\n\n            // Observe size changes in parent and grandparent.\n             const resizeObserver = new ResizeObserver(() => {\n                updateEditableHeight();\n            });\n             resizeObserver.observe(sourceTextSinglelang);\n             // ResizeObserver.observe(sourceTextMultilang);\n             // ResizeObserver.observe(grandparent);\n\n        });\n    };\n\n\n    /**\n     * Toggle Autotranslate Button\n     */\n    const toggleAutotranslateButton = () => {\n        // Use Array.some() for early exit when a checked checkbox is found\n        autotranslateButton.disabled = !Array.from(checkboxes).some(e => e.checked);\n    };\n\n    /**\n     * Toggle checkboxes\n     * @param {Boolean} checked\n     */\n    const toggleAllCheckboxes = (checked) => {\n        const updates = [];\n        // Prepare all updates without applying immediately.\n        checkboxes.forEach(checkbox => {\n            // Parent row.\n            let parent;\n            if (!checkBoxParentMap.has(checkbox)) {\n                parent = Utils.getParentRow(checkbox, Selectors.sourcetexts.parentrow);\n                checkBoxParentMap.set(checkbox, parent);\n            } else {\n                parent = checkBoxParentMap.get(checkbox);\n            }\n            // If the row is checked, verifiy that the parent is not hidden else do not select.\n            const shouldCheck = checked ? !parent.classList.contains('d-none') : false;\n            if (checkbox.checked !== shouldCheck) {\n                updates.push({checkbox, shouldCheck});\n            }\n        });\n        // Apply updates in the next animation frame, batching DOM writes.\n        requestAnimationFrame(() => {\n            updates.forEach(({checkbox, shouldCheck}) => {\n                checkbox.checked = shouldCheck;\n                const key = checkbox.getAttribute('data-key');\n                toggleStatus(key, shouldCheck, Translation.translated(key));\n            });\n            toggleAutotranslateButton();\n            countWordAndChar();\n        });\n    };\n    const toggleGlossaryDetails = (glossaryId)=> {\n        if (glossaryId !== '') {\n            glossaryDetailViewr.style.display = 'block';\n        } else {\n            glossaryDetailViewr.style.display = 'none';\n        }\n    };\n    /**\n     * Wrap debounce for displaying rows.\n     * @type {(function(...[*]): void)|*}\n     */\n    const debouncedShowRows = Utils.debounce(() => {\n        showRows();\n    }, 100);\n    /**\n     * Shows/hides rows.\n     */\n    const showRows = () => {\n        // Map each selector to its corresponding checkbox checked state\n        const selectorMap = {\n            [Selectors.statuses.updated]: Utils.domQuery(Selectors.actions.showUpdated).checked,\n            [Selectors.statuses.needsupdate]: Utils.domQuery(Selectors.actions.showNeedUpdate).checked,\n            [Selectors.statuses.hidden]: Utils.domQuery(Selectors.actions.showHidden).checked\n        };\n\n        // Combine all selectors into one comma-separated string for batch querying.\n        const mergedSelector = Object.keys(selectorMap).join(\",\");\n\n        // Query all items matching any of the selectors once.\n        const allItems = Utils.domQueryAll(mergedSelector);\n\n        // Cache the global \"select all\" button checked state once.\n        const allSelected = Utils.domQuery(Selectors.actions.selectAllBtn).checked;\n\n        allItems.forEach(item => {\n            // Determine which selector this item matches so we can apply the right checkbox state.\n            let shouldShow = false;\n            let shouldCheck = false;\n            for (const [selector, checked] of Object.entries(selectorMap)) {\n                if (item.matches(selector)) {\n                    shouldShow = checked;\n                    shouldCheck = allSelected && checked;\n                    break;\n                }\n            }\n\n            // Show or hide item based on checkbox state.\n            item.classList.toggle(\"d-none\", !shouldShow);\n\n            // Handle checkbox selection for this item or its children.\n            let rowId = item.getAttribute('data-row-id');\n            if (rowId === null) {\n                // For items without row-id, toggle checkboxes of their child rows.\n                const childs = Utils.domQueryAll(Selectors.statuses.hiddenForStudentRows, '', item);\n                childs.forEach(child => {\n                    const childId = child.getAttribute('data-row-id');\n                    toggleChildCheckBoxSelection(childId, shouldCheck);\n                });\n            } else {\n                toggleChildCheckBoxSelection(rowId, shouldCheck);\n            }\n        });\n\n        // Call global UI update functions once\n        toggleAutotranslateButton();\n        countWordAndChar();\n        resizeEditors();\n    };\n    /**\n     * Manages selection and icon status of fields.\n     *\n     * @param {string} key\n     * @param {bool} shouldBeChecked\n     */\n    const toggleChildCheckBoxSelection = (key, shouldBeChecked)=>{\n        const single = Utils.domQuery(Selectors.editors.multiples.checkBoxesWithKey, key);\n        single.checked = shouldBeChecked;\n        toggleStatus(key, false, Translation.translated(key));\n    };\n/*    Const togglePreloader = () => {\n        if (preloader?.classList.contains('show') || preloader?.classList.contains('d-block')) {\n            preloader.classList.remove('show', 'd-block');\n            preloader.classList.add('d-none');\n        } else {\n            preloader.classList.remove('d-none');\n            preloader.classList.add('show', 'd-block');\n        }\n    };*/\n\n    const wrapTinyOnTarget = (element)=>{\n        const status = getIconStatus(element.id.replace('tiny_', ''));\n        if (status === Selectors.statuses.tosave) {\n            // eslint-disable-next-line promise/catch-or-return\n            TinyMCEinit.getTinyMCE().then(\n                // eslint-disable-next-line promise/always-return\n                ()=>{\n                    // eslint-disable-next-line promise/no-nesting\n                    TinyMCE.setupForTarget(element, optionsForTiny)\n                        // eslint-disable-next-line promise/always-return\n                        .then(()=>{\n                            Log.info('tiny loaded for ' + element.id);\n                        })\n                        .catch((r)=>{\n                            Log.error(r);\n                        });\n                }\n            );\n        }\n    };\n    const disableSaveButton = ()=>{\n        saveAllBtn.disabled = true;\n    };\n    const enableSaveButton = ()=>{\n        saveAllBtn.disabled = false;\n    };\n    const disableTranslateButton = ()=>{\n        autotranslateButton.disabled = true;\n    };\n    const enableTranslateButton = ()=>{\n        autotranslateButton.disabled = true;\n    };\n    const registerUI = () => {\n        if (!glossaryDetailViewr && document.querySelector(Selectors.glossary.entriesviewerPage)) {\n            glossaryDetailViewr = document.querySelector(Selectors.glossary.entriesviewerPage);\n        }\n        autotranslateButton = Utils.domQuery(Selectors.actions.autoTranslateBtn);\n        checkboxes = Utils.domQueryAll(Selectors.actions.checkBoxes);\n        allDataFormatOne = Utils.domQueryAll(Selectors.editors.targetarea);\n        selectAllBtn = Utils.domQuery(Selectors.actions.selectAllBtn);\n        saveAllBtn = Utils.domQuery(Selectors.actions.saveAll);\n        langstrings = JSON.parse(Utils.domQuery(Selectors.config.langstrings).getAttribute('data-langstrings'));\n    };\n    const init = (cfg) => {\n        // Preloader = pr;\n        config = cfg;\n        registerUI();\n        // Make the main UI adjustments\n        doHideiframes();\n        toggleAutotranslateButton();\n        // SaveAllBtn.disabled = true;\n        disableSaveButton();\n        selectAllBtn.disabled = config.targetlang === '';\n        checkboxes.forEach((node) => {\n            node.disabled = selectAllBtn.disabled;\n        });\n        debouncedShowRows();\n    };\n    return {\n        ON_STATUS_CHANGED: ON_STATUS_CHANGED,\n        backToBase: backToBase,\n        countWordAndChar: countWordAndChar,\n        dbErrorModal: dbErrorModal,\n        dbErrorPartialModal: dbErrorPartialModal,\n        disableSaveButton: disableSaveButton,\n        disableTranslateButton: disableTranslateButton,\n        enableSaveButton: enableSaveButton,\n        enableTranslateButton: enableTranslateButton,\n        debouncedShowRows: debouncedShowRows,\n        deeplErrorModal: deeplErrorModal,\n        doHideiframes: doHideiframes,\n        findEditor: findEditor,\n        getIconStatus: getIconStatus,\n        hideModal: hideModal,\n        hideErrorMessage: hideErrorMessage,\n        init: init,\n        launchModal: launchModal,\n        launchSaveAllModal: launchSaveAllModal,\n        launchTranslatingModal: launchTranslatingModal,\n        presentDialogModal: presentDialogModal,\n        setIconStatus: setIconStatus,\n        showEntriesModal: showEntriesModal,\n        showErrorMessageForEditor: showErrorMessageForEditor,\n        toggleAllCheckboxes: toggleAllCheckboxes,\n        toggleAutotranslateButton: toggleAutotranslateButton,\n        toggleGlossaryDetails: toggleGlossaryDetails,\n        toggleStatus: toggleStatus,\n        wrapTinyOnTarget: wrapTinyOnTarget\n    };\n});\n"],"names":["define","Modal","Log","TinyMCEinit","TinyMCE","Utils","Selectors","Events","Translation","glossaryDetailViewr","config","format","Intl","NumberFormat","autotranslateButton","saveAllBtn","saveAllModal","langstrings","selectAllBtn","removedIframes","allDataFormatOne","checkboxes","checkBoxParentMap","Map","optionsForTiny","subdirs","maxbytes","maxfiles","noclean","trusttext","enable_filemanagement","autosave","removeorphaneddrafts","plugins","cachedSelectors","wordCount","document","querySelector","statuses","wordcount","charWithSpace","charNumWithSpace","charWOSpace","charNumWithOutSpace","deeplUseSpan","deeplUsage","deeplMaxSpan","deeplMax","deeplStatusContainer","doHideiframes","isChecked","domQuery","actions","hideiframes","allIframes","domQueryAll","sourcetexts","iframes","length","forEach","iframe","push","parent","parentNode","nextSibling","html","outerHTML","remove","info","tempDiv","createElement","innerHTML","newIframe","firstChild","insertBefore","appendChild","findEditorByType","key","editorType","et","ed","editors","types","atto","findTinyInstanceByKey","other","editor","getAllInstances","every","k","v","attributes","name","value","indexOf","getBody","countWordAndChar","wrdsc","cws","cwos","Array","from","checkedCheckBoxes","ckBox","getAttribute","results","getCount","current","usage","character","count","innerText","limit","classList","toggle","raw","singlelangkeys","trimmedVal","stripHTMLTags","fromBase64","trim","match","replace","toggleStatus","checked","translated","icon","validatorBtn","status","dataset","disaptchStatus","wait","setIconElementStatus","totranslate","tosave","failed","success","saved","emit","isBtn","contains","add","setAttribute","title","statusstrings","getIconStatus","launchModal","async","create","messageObject","show","dbErrorModal","body","titleSuffix","uistrings","errordbtitle","presentDialogModal","type","removeOnClose","resizeEditors","editable","grandparent","closest","sourceTextSinglelang","singlelang","ResizeObserver","window","console","log","offsetHeight","totalHeight","style","height","updateEditableHeight","observe","toggleAutotranslateButton","disabled","some","e","debouncedShowRows","debounce","showRows","selectorMap","updated","showUpdated","needsupdate","showNeedUpdate","hidden","showHidden","mergedSelector","Object","keys","join","allItems","allSelected","item","shouldShow","shouldCheck","selector","entries","matches","rowId","hiddenForStudentRows","child","childId","toggleChildCheckBoxSelection","shouldBeChecked","multiples","checkBoxesWithKey","disableSaveButton","ON_STATUS_CHANGED","backToBase","offsetTop","scrollTo","top","behavior","dbErrorPartialModal","stringVar","errordbpartial","disableTranslateButton","enableSaveButton","enableTranslateButton","deeplErrorModal","deeplapiexception","findEditor","basic","r","userPrefs","warn","error","trace","hideModal","isVisible","hide","hideErrorMessage","editorsWithKey","alertChild","removeChild","init","cfg","glossary","entriesviewerPage","autoTranslateBtn","checkBoxes","targetarea","saveAll","JSON","parse","targetlang","node","launchSaveAllModal","saveallmodaltitle","saveallmodalbody","then","catch","reason","launchTranslatingModal","translatemodaltitle","translatemodalbody","setIconStatus","showEntriesModal","ajaxResponse","glossaryid","message","table","className","thead","source","toUpperCase","target","tbody","_ref","row","showErrorMessageForEditor","errorMsg","substring","errortoolong","id","toggleAllCheckboxes","updates","checkbox","has","get","getParentRow","parentrow","set","requestAnimationFrame","_ref2","toggleGlossaryDetails","glossaryId","display","wrapTinyOnTarget","element","getTinyMCE","setupForTarget"],"mappings":"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"}