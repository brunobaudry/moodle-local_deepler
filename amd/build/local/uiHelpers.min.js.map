{"version":3,"file":"uiHelpers.min.js","sources":["../../src/local/uiHelpers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  description here.\n *\n * @module     'local_deepler'; // Full name of the plugin (used for diagnostics)./local/uiHelpers\n * @copyright  2025 Bruno Baudry <bruno.baudry@bfh.ch>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['core/modal',\n    'core/log',\n    'editor_tiny/loader',\n    'editor_tiny/editor',\n    './utils',\n    './selectors',\n    './customevents',\n    './translation'\n    ], (\n        Modal,\n        Log,\n        TinyMCEinit,\n        TinyMCE,\n        Utils,\n        Selectors,\n        Events,\n        Translation)=>{\n    // Let preloader;\n    let config = {};\n    let format = new Intl.NumberFormat();\n    let autotranslateButton = {};\n    let saveAllBtn = {};\n    let saveAllModal = {};\n    let langstrings = {};\n    let selectAllBtn = {};\n    let removedIframes = [];\n    let allDataFormatOne = [];\n    let checkboxes = [];\n    let glossaryDetailViewr;\n    let checkBoxParentMap = new Map();\n    const optionsForTiny = {\n        subdirs: false,\n        maxbytes: 10240,\n        maxfiles: 0,\n        noclean: true,\n        trusttext: true,\n        // eslint-disable-next-line camelcase\n        enable_filemanagement: false,\n        autosave: false,\n        removeorphaneddrafts: true,\n        plugins: []\n    };\n    const ON_STATUS_CHANGED = 'onStatusChanged';\n    // Cached DOM elements\n    const cachedSelectors = {\n        wordCount: document.querySelector(Selectors.statuses.wordcount),\n        charWithSpace: document.querySelector(Selectors.statuses.charNumWithSpace),\n        charWOSpace: document.querySelector(Selectors.statuses.charNumWithOutSpace),\n        deeplUseSpan: document.querySelector(Selectors.statuses.deeplUsage),\n        deeplMaxSpan: document.querySelector(Selectors.statuses.deeplMax),\n        deeplStatusContainer: document.querySelector(Selectors.statuses.deeplStatusContainer)\n    };\n    /**\n     * Toggle iFrames in sourcetexts.\n     */\n    function doHideiframes() {\n        const isChecked = Utils.domQuery(Selectors.actions.hideiframes);\n        const allIframes = Utils.domQueryAll(Selectors.sourcetexts.iframes);\n        if (!isChecked && allIframes.length > 0) {\n            removedIframes = [];\n            allIframes.forEach(iframe => {\n                removedIframes.push({\n                    parent: iframe.parentNode,\n                    nextSibling: iframe.nextSibling,\n                    html: iframe.outerHTML\n                });\n                iframe.remove();\n            });\n        } else if (removedIframes.length > 0) {\n            // Restore all previously removed iframes.\n            removedIframes.forEach(info => {\n                // Create a new element from the stored HTML.\n                const tempDiv = document.createElement('div');\n                tempDiv.innerHTML = info.html;\n                const newIframe = tempDiv.firstChild;\n                // Insert it back into the DOM\n                if (info.nextSibling) {\n                    info.parent.insertBefore(newIframe, info.nextSibling);\n                } else {\n                    info.parent.appendChild(newIframe);\n                }\n            });\n            removedIframes = [];\n        }\n    }\n    /**\n     * Get the editor container based on recieved current user's editor preference.\n     *\n     * @param {string} key Translation Key\n     */\n    const findEditor = (key) => {\n        let e = Utils.domQuery(Selectors.editors.types.basic, key);\n        let et = 'basic';\n        if (e === null) {\n            let r = null;\n            let editorTab = [\"atto\", \"tiny\", \"marklar\", \"textarea\"];\n            if (editorTab.indexOf(config.userPrefs) === -1) {\n                Log.warn('Unsupported editor ' + config.userPrefs);\n            } else {\n                // First let's try the current editor.\n                try {\n                    r = findEditorByType(key, config.userPrefs);\n                } catch (error) {\n                    // Content was edited by another editor.\n                    Log.trace(`Editor not found: ${config.userPrefs} for key ${key}`);\n                }\n            }\n            return r;\n        } else {\n            return {editor: e, editorType: et};\n        }\n    };\n    /**\n     * @param {string} key\n     * @param {object} editorType\n     * @returns {{editor: object, editorType: string}}\n     */\n    const findEditorByType = (key, editorType) => {\n        let et = 'basic';\n        let ed = null;\n        switch (editorType) {\n            case \"atto\" :\n                et = 'iframe';\n                ed = Utils.domQuery(Selectors.editors.types.atto, key);\n                break;\n            case \"tiny\":\n                et = 'iframe';\n                ed = findTinyInstanceByKey(key);\n                break;\n            case 'marklar':\n            case \"textarea\" :\n                ed = Utils.domQuery(Selectors.editors.types.other, key);\n                break;\n        }\n        return {editor: ed, editorType: et};\n    };\n    /**\n     * Finds TinyMCE instance.\n     * @param {string} key\n     * @returns {Node}\n     */\n    const findTinyInstanceByKey = (key)=> {\n        let editor = null;\n        TinyMCE.getAllInstances().every((k, v)=>{\n            if (v.attributes.name.value.indexOf(key) === 0) {\n                editor = k.getBody();\n                return false;\n            }\n            return true;\n        });\n        return editor;\n    };\n    /**\n     * Hides an item's error message.\n     *\n     * @param {String} key\n     */\n    const hideErrorMessage = (key) => {\n        let parent = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n        let alertChild = Utils.domQuery('.alert-danger', '', parent);\n        if (alertChild) {\n            parent.removeChild(alertChild);\n        }\n    };\n    /**\n     * Display an error message attached to the item's editor.\n     * @param {String} key\n     * @param {String} message\n     */\n    const showErrorMessageForEditor = (key, message) => {\n        let parent = Utils.domQuery(Selectors.editors.multiples.editorsWithKey, key);\n        const errorMsg = document.createElement('div');\n        const indexOfSET = message.indexOf(\"Data too long\");// Probably a text too long for the field if not -1.\n        // Display granular error messages.\n        if (indexOfSET > -1) {\n            message = message.substring(0, message.indexOf('WHERE id=?'));\n            message = message + ' ' + langstrings.uistrings.errortoolong;\n        }\n        errorMsg.id = 'local_deepler__errormsg';\n        errorMsg.classList = ['alert alert-danger'];\n        errorMsg.innerHTML = message;\n        parent.appendChild(errorMsg);\n    };\n    const showEntriesModal = (ajaxResponse)=>{\n        const glossaryid = ajaxResponse.glossaryid;\n        const entries = JSON.parse(ajaxResponse.entries);\n        const status = ajaxResponse.status;\n        const message = ajaxResponse.message;\n        if (status === 'success') {\n            const table = document.createElement('table');\n            table.className = 'generaltable';\n            // Create the header.\n            const thead = document.createElement('thead');\n            thead.innerHTML = `<tr><th>${ajaxResponse.source.toUpperCase()}</th>\n                <th>${ajaxResponse.target.toUpperCase()}</th></tr>`;\n            table.appendChild(thead);\n\n            const tbody = document.createElement('tbody');\n\n            Object.entries(entries).forEach(([key, value]) => {\n                const row = document.createElement('tr');\n                row.innerHTML = `<td>${key}</td><td>${value}</td>`;\n                tbody.appendChild(row);\n            });\n\n            table.appendChild(tbody);\n\n            Modal.create({\n                title: 'Entries',\n                body: table,\n                type: 'default',\n                show: true,\n                removeOnClose: true,\n            });\n        } else {\n            Modal.create({\n                title: `Error fetching entries for<br/><em>${glossaryid}</em>`,\n                body: message,\n                type: 'default',\n                show: true,\n                removeOnClose: true,\n            });\n        }\n    };\n    /**\n     * Launch, display count of Words And Chars.\n     */\n    const countWordAndChar = () => {\n        let wrdsc = 0,\n            cws = 0,\n            cwos = 0;\n\n        // Cache checkboxes matching selector once, convert to array if needed.\n        const checkedBoxes = Array.from(Utils.domQueryAll(Selectors.statuses.checkedCheckBoxes));\n\n        // Aggregate counts in one loop.\n        checkedBoxes.forEach(ckBox => {\n            const key = ckBox.getAttribute(\"data-key\");\n            const results = getCount(key);\n            wrdsc += results.wordCount;\n            cws += results.charNumWithSpace;\n            cwos += results.charNumWithOutSpace;\n        });\n\n        // Cache DOM elements once for output instead of querying repeatedly.\n        const wordCount = cachedSelectors.wordCount;\n        const charWithSpace = cachedSelectors.charWithSpace;\n        const charWOSpace = cachedSelectors.charWOSpace;\n        const deeplUseSpan = cachedSelectors.deeplUseSpan;\n        const deeplMaxSpan = cachedSelectors.deeplMaxSpan;\n        const parent = cachedSelectors.deeplStatusContainer;\n\n        // Calculate current usage once.\n        const current = cws + config.usage.character.count;\n\n        // Update UI in one batch (minimizes layout thrashing).\n        wordCount.innerText = wrdsc;\n        charWithSpace.innerText = cws;\n        charWOSpace.innerText = cwos;\n        deeplUseSpan.innerText = format.format(current);\n        deeplMaxSpan.innerText = config.usage.character.limit === null ? 'âˆž' : format.format(config.usage.character.limit);\n\n        // Toggle classes efficiently.\n        parent.classList.toggle('alert-success', current < config.usage.character.limit || config.usage.character.limit === null);\n        parent.classList.toggle('alert-danger', current >= config.usage.character.limit && config.usage.character.limit !== null);\n    };\n    /**\n     * Compile the needed counts for info.\n     *\n     * @param {string} key\n     * @returns {{wordCount: *, charNumWithSpace: *, charNumWithOutSpace: *}}\n     */\n    const getCount = (key) => {\n        const item = Utils.domQuery(Selectors.sourcetexts.keys, key);\n        const raw = item.getAttribute(\"data-sourcetext-raw\");\n        // Cleaned sourceText.\n        const trimmedVal = Utils.stripHTMLTags(Utils.fromBase64(raw)).trim();\n        return {\n            \"wordCount\": (trimmedVal.match(/\\S+/g) || []).length,\n            \"charNumWithSpace\": trimmedVal.length,\n            \"charNumWithOutSpace\": trimmedVal.replace(/\\s+/g, '').length\n        };\n    };\n\n    /**\n     * Factory to display process' statuses for each item.\n     *\n     * @param {String} key\n     * @param {Boolean} checked\n     * @param {Boolean} translated\n     * @todo MDL-0000 optimize\n     */\n    const toggleStatus = (key, checked, translated) => {\n        const icon = Utils.domQuery(Selectors.actions.validatorBtn, key);\n        const status = icon?.dataset.status;\n\n        if (!status) {\n            return;\n        }\n\n        switch (status) {\n            case Selectors.statuses.wait:\n                Events.emit(ON_STATUS_CHANGED, key);\n                if (checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                }\n                break;\n\n            case Selectors.statuses.totranslate:\n                if (checked && translated) {\n                    setIconElementStatus(icon, Selectors.statuses.tosave, true);\n                } else {\n                    setIconElementStatus(icon, Selectors.statuses.wait);\n                }\n                break;\n\n            case Selectors.statuses.tosave:\n                if (!checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                }\n                break;\n\n            case Selectors.statuses.failed:\n                if (checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                }\n                break;\n\n            case Selectors.statuses.success:\n                break;\n\n            case Selectors.statuses.saved:\n                if (checked) {\n                    setIconElementStatus(icon, Selectors.statuses.totranslate);\n                }\n                Events.emit(ON_STATUS_CHANGED, key);\n                break;\n        }\n    };\n    /**\n     * Change translation process status icon.\n     *\n     * @param {element} icon\n     * @param {string} status\n     * @param {boolean} isBtn\n     * @todo MDL-0000 optimize\n     */\n    const setIconElementStatus = (icon, status = Selectors.statuses.wait, isBtn = false) => {\n        if (!icon) {\n         return;\n        }\n\n        const classList = icon.classList;\n\n        // Update classes only if needed\n        if (isBtn) {\n            if (!classList.contains('btn')) {\n                classList.add('btn', 'btn-outline-secondary');\n            }\n            if (classList.contains('disable')) {\n                classList.remove('disable');\n            }\n        } else {\n            if (!classList.contains('disable')) {\n                classList.add('disable');\n            }\n            if (classList.contains('btn')) {\n                classList.remove('btn', 'btn-outline-secondary');\n            }\n        }\n\n        // Update attributes only if changed\n        if (icon.getAttribute('role') !== (isBtn ? 'button' : 'status')) {\n            icon.setAttribute('role', isBtn ? 'button' : 'status');\n        }\n\n        if (icon.dataset.status !== status) {\n            icon.setAttribute('data-status', status);\n        }\n\n        const title = langstrings.statusstrings[status.replace('local_deepler/', '')];\n        if (icon.getAttribute('title') !== title) {\n            icon.setAttribute('title', title);\n        }\n    };\n\n   /* Const toggleStatus = (key, checked, translated) => {\n        const status = Utils.domQuery(Selectors.actions.validatorBtn, key).dataset.status;\n        switch (status) {\n            case Selectors.statuses.wait :\n                Events.emit(ON_STATUS_CHANGED, key);\n                if (checked) {\n                    setIconStatus(key, Selectors.statuses.totranslate);\n                }\n                break;\n            case Selectors.statuses.totranslate :\n                if (checked && translated) {\n                    setIconStatus(key, Selectors.statuses.tosave, true);\n                } else {\n                    setIconStatus(key, Selectors.statuses.wait);\n                }\n                break;\n            case Selectors.statuses.tosave :\n                if (!checked) {\n                    setIconStatus(key, Selectors.statuses.totranslate);\n                }\n                break;\n            case Selectors.statuses.failed :\n                if (checked) {\n                    setIconStatus(key, Selectors.statuses.totranslate);\n                }\n                break;\n            case Selectors.statuses.success :\n                break;\n            case Selectors.statuses.saved :\n                if (checked) {\n                    setIconStatus(key, Selectors.statuses.totranslate);\n                }\n                Events.emit(ON_STATUS_CHANGED, key);\n                break;\n        }\n    };*/\n\n    const setIconStatus = (key, status = Selectors.statuses.wait, isBtn = false) => {\n        let icon = Utils.domQuery(Selectors.actions.validatorBtn, key);\n        setIconElementStatus(icon, status, isBtn);\n       /* If (!isBtn) {\n            if (!icon.classList.contains('disable')) {\n                icon.classList.add('disable');\n            }\n            if (icon.classList.contains('btn')) {\n                icon.classList.remove('btn');\n                icon.classList.remove('btn-outline-secondary');\n            }\n        } else {\n            if (!icon.classList.contains('btn')) {\n                icon.classList.add('btn');\n                icon.classList.add('btn-outline-secondary');\n            }\n            if (icon.classList.contains('disable')) {\n                icon.classList.remove('disable');\n            }\n        }\n        icon.setAttribute('role', isBtn ? 'button' : 'status');\n        icon.setAttribute('data-status', status);\n        icon.setAttribute('title', langstrings.statusstrings[status.replace('local_deepler/', '')]);*/\n    };\n    /**\n     * Get the translation row status icon.\n     *\n     * @param {string} key\n     * @returns {*}\n     */\n    const getIconStatus = (key)=> {\n        return Utils.domQuery(Selectors.actions.validatorBtn, key).getAttribute('data-status');\n    };\n    /**\n     * Opens a modal infobox to warn user trunks of fields are saving.\n     * @param {object} messageObject\n     * @returns {Promise<void>}\n     */\n    const launchModal = async(messageObject) => {\n        saveAllModal = await Modal.create(messageObject);\n        await saveAllModal.show();\n    };\n    const launchTranslatingModal = ()=>{\n        return launchModal(\n            {\n                title: langstrings.uistrings.translatemodaltitle,\n                body: langstrings.uistrings.translatemodalbody,\n            }\n        );\n    };\n    const launchSaveAllModal = ()=>{\n        launchModal(\n            {\n                title: langstrings.uistrings.saveallmodaltitle,\n                body: langstrings.uistrings.saveallmodalbody,\n            }\n        ).then(r => Log.info('SaveAll Modal launched ' + r)).catch((reason)=>{\n            Log.error(reason);\n        });\n    };\n    const dbErrorPartialModal = (stringVar)=>{\n        const body = langstrings.uistrings.errordbpartial.replace('{$a}', stringVar);\n        dbErrorModal(body);\n    };\n    const dbErrorModal = (body, titleSuffix = '')=>{\n        let title = langstrings.uistrings.errordbtitle;\n        if (titleSuffix !== '') {\n            title += titleSuffix;\n        }\n        presentDialogModal(title, body, 'alert');\n    };\n    const deeplErrorModal = (body)=>{\n        presentDialogModal(langstrings.uistrings.deeplapiexception, body, 'Alert');\n    };\n    const presentDialogModal = (title, body, type = 'default') => {\n        Modal.create({\n            title: title,\n            body: body,\n            type: type,\n            show: true,\n            removeOnClose: true,\n        });\n    };\n\n    const hideModal = ()=>{\n        if (saveAllModal !== null && saveAllModal.isVisible) {\n            saveAllModal.hide();\n        }\n    };\n    const backToBase = () => {\n        const offsetTop = Utils.domQuery(Selectors.config.langstrings).offsetTop;\n        window.scrollTo({top: offsetTop - 5, behavior: 'smooth'});\n    };\n    const resizeEditors = ()=>{\n\n        allDataFormatOne.forEach((editable)=>{\n            const key = editable.id.replace('tiny_', '');\n            const selector = `[data-sourcetext-key=\"${key}\"]`;\n            let parent = Utils.domQuery(selector);\n            const grandparent = parent.parentElement;\n\n            const updateEditableHeight = ()=> {\n                const totalHeight = grandparent.offsetHeight + 80; // Tiny header average height is 80.\n                editable.style.height = totalHeight + 'px';\n            };\n\n            // Observe size changes in parent and grandparent.\n            const resizeObserver = new ResizeObserver(() => {\n                updateEditableHeight();\n            });\n\n            resizeObserver.observe(parent);\n            resizeObserver.observe(grandparent);\n\n        });\n    };\n\n\n    /**\n     * Toggle Autotranslate Button\n     */\n    const toggleAutotranslateButton = () => {\n        // Use Array.some() for early exit when a checked checkbox is found\n        autotranslateButton.disabled = !Array.from(checkboxes).some(e => e.checked);\n    };\n\n    /**\n     * Toggle checkboxes\n     * @param {Boolean} checked\n     */\n    const toggleAllCheckboxes = (checked) => {\n        const updates = [];\n        // Prepare all updates without applying immediately.\n        checkboxes.forEach(checkbox => {\n            // Parent row.\n            let parent;\n            if (!checkBoxParentMap.has(checkbox)) {\n                parent = Utils.getParentRow(checkbox, Selectors.sourcetexts.parentrow);\n                checkBoxParentMap.set(checkbox, parent);\n            } else {\n                parent = checkBoxParentMap.get(checkbox);\n            }\n            // If the row is checked, verifiy that the parent is not hidden else do not select.\n            const shouldCheck = checked ? !parent.classList.contains('d-none') : false;\n            if (checkbox.checked !== shouldCheck) {\n                updates.push({checkbox, shouldCheck});\n            }\n        });\n        // Apply updates in the next animation frame, batching DOM writes.\n        requestAnimationFrame(() => {\n            updates.forEach(({checkbox, shouldCheck}) => {\n                checkbox.checked = shouldCheck;\n                const key = checkbox.getAttribute('data-key');\n                toggleStatus(key, shouldCheck, Translation.translated(key));\n            });\n            toggleAutotranslateButton();\n            countWordAndChar();\n        });\n    };\n    const toggleGlossaryDetails = (glossaryId)=> {\n        if (glossaryId !== '') {\n            glossaryDetailViewr.style.display = 'block';\n        } else {\n            glossaryDetailViewr.style.display = 'none';\n        }\n    };\n    /**\n     * Wrap debounce for displaying rows.\n     * @type {(function(...[*]): void)|*}\n     */\n    const debouncedShowRows = Utils.debounce(() => {\n        showRows();\n    }, 100);\n    /**\n     * Shows/hides rows.\n     */\n    const showRows = () => {\n        // Map each selector to its corresponding checkbox checked state\n        const selectorMap = {\n            [Selectors.statuses.updated]: Utils.domQuery(Selectors.actions.showUpdated).checked,\n            [Selectors.statuses.needsupdate]: Utils.domQuery(Selectors.actions.showNeedUpdate).checked,\n            [Selectors.statuses.hidden]: Utils.domQuery(Selectors.actions.showHidden).checked\n        };\n\n        // Combine all selectors into one comma-separated string for batch querying.\n        const mergedSelector = Object.keys(selectorMap).join(\",\");\n\n        // Query all items matching any of the selectors once.\n        const allItems = Utils.domQueryAll(mergedSelector);\n\n        // Cache the global \"select all\" button checked state once.\n        const allSelected = Utils.domQuery(Selectors.actions.selectAllBtn).checked;\n\n        allItems.forEach(item => {\n            // Determine which selector this item matches so we can apply the right checkbox state.\n            let shouldShow = false;\n            let shouldCheck = false;\n            for (const [selector, checked] of Object.entries(selectorMap)) {\n                if (item.matches(selector)) {\n                    shouldShow = checked;\n                    shouldCheck = allSelected && checked;\n                    break;\n                }\n            }\n\n            // Show or hide item based on checkbox state.\n            item.classList.toggle(\"d-none\", !shouldShow);\n\n            // Handle checkbox selection for this item or its children.\n            let rowId = item.getAttribute('data-row-id');\n            if (rowId === null) {\n                // For items without row-id, toggle checkboxes of their child rows.\n                const childs = Utils.domQueryAll(Selectors.statuses.hiddenForStudentRows, '', item);\n                childs.forEach(child => {\n                    const childId = child.getAttribute('data-row-id');\n                    toggleChildCheckBoxSelection(childId, shouldCheck);\n                });\n            } else {\n                toggleChildCheckBoxSelection(rowId, shouldCheck);\n            }\n        });\n\n        // Call global UI update functions once\n        toggleAutotranslateButton();\n        countWordAndChar();\n    };\n    /**\n     * Manages selection and icon status of fields.\n     *\n     * @param {string} key\n     * @param {bool} shouldBeChecked\n     */\n    const toggleChildCheckBoxSelection = (key, shouldBeChecked)=>{\n        const single = Utils.domQuery(Selectors.editors.multiples.checkBoxesWithKey, key);\n        single.checked = shouldBeChecked;\n        toggleStatus(key, false, Translation.translated(key));\n    };\n/*    Const togglePreloader = () => {\n        if (preloader?.classList.contains('show') || preloader?.classList.contains('d-block')) {\n            preloader.classList.remove('show', 'd-block');\n            preloader.classList.add('d-none');\n        } else {\n            preloader.classList.remove('d-none');\n            preloader.classList.add('show', 'd-block');\n        }\n    };*/\n\n    const wrapTinyOnTarget = (element)=>{\n        const status = getIconStatus(element.id.replace('tiny_', ''));\n        if (status === Selectors.statuses.tosave) {\n            // eslint-disable-next-line promise/catch-or-return\n            TinyMCEinit.getTinyMCE().then(\n                // eslint-disable-next-line promise/always-return\n                ()=>{\n                    // eslint-disable-next-line promise/no-nesting\n                    TinyMCE.setupForTarget(element, optionsForTiny)\n                        // eslint-disable-next-line promise/always-return\n                        .then(()=>{\n                            Log.info('tiny loaded for ' + element.id);\n                        })\n                        .catch((r)=>{\n                            Log.error(r);\n                        });\n                }\n            );\n        }\n    };\n    const disableSaveButton = ()=>{\n        saveAllBtn.disabled = true;\n    };\n    const enableSaveButton = ()=>{\n        saveAllBtn.disabled = false;\n    };\n    const disableTranslateButton = ()=>{\n        autotranslateButton.disabled = true;\n    };\n    const enableTranslateButton = ()=>{\n        autotranslateButton.disabled = true;\n    };\n    const registerUI = () => {\n        if (!glossaryDetailViewr && document.querySelector(Selectors.glossary.entriesviewerPage)) {\n            glossaryDetailViewr = document.querySelector(Selectors.glossary.entriesviewerPage);\n        }\n        autotranslateButton = Utils.domQuery(Selectors.actions.autoTranslateBtn);\n        checkboxes = Utils.domQueryAll(Selectors.actions.checkBoxes);\n        allDataFormatOne = Utils.domQueryAll(Selectors.editors.targetarea);\n        selectAllBtn = Utils.domQuery(Selectors.actions.selectAllBtn);\n        saveAllBtn = Utils.domQuery(Selectors.actions.saveAll);\n        langstrings = JSON.parse(Utils.domQuery(Selectors.config.langstrings).getAttribute('data-langstrings'));\n    };\n    const init = (cfg) => {\n        // Preloader = pr;\n        config = cfg;\n        registerUI();\n        // Make the main UI adjustments\n        resizeEditors();\n        doHideiframes();\n        toggleAutotranslateButton();\n        // SaveAllBtn.disabled = true;\n        disableSaveButton();\n        selectAllBtn.disabled = config.targetlang === '';\n        checkboxes.forEach((node) => {\n            node.disabled = selectAllBtn.disabled;\n        });\n        debouncedShowRows();\n    };\n    return {\n        ON_STATUS_CHANGED: ON_STATUS_CHANGED,\n        backToBase: backToBase,\n        countWordAndChar: countWordAndChar,\n        dbErrorModal: dbErrorModal,\n        dbErrorPartialModal: dbErrorPartialModal,\n        disableSaveButton: disableSaveButton,\n        disableTranslateButton: disableTranslateButton,\n        enableSaveButton: enableSaveButton,\n        enableTranslateButton: enableTranslateButton,\n        debouncedShowRows: debouncedShowRows,\n        deeplErrorModal: deeplErrorModal,\n        doHideiframes: doHideiframes,\n        findEditor: findEditor,\n        getIconStatus: getIconStatus,\n        hideModal: hideModal,\n        hideErrorMessage: hideErrorMessage,\n        init: init,\n        launchModal: launchModal,\n        launchSaveAllModal: launchSaveAllModal,\n        launchTranslatingModal: launchTranslatingModal,\n        presentDialogModal: presentDialogModal,\n        setIconStatus: setIconStatus,\n        showEntriesModal: showEntriesModal,\n        showErrorMessageForEditor: showErrorMessageForEditor,\n        toggleAllCheckboxes: toggleAllCheckboxes,\n        toggleAutotranslateButton: toggleAutotranslateButton,\n        toggleGlossaryDetails: toggleGlossaryDetails,\n        toggleStatus: toggleStatus,\n        wrapTinyOnTarget: wrapTinyOnTarget\n    };\n});\n"],"names":["define","Modal","Log","TinyMCEinit","TinyMCE","Utils","Selectors","Events","Translation","glossaryDetailViewr","config","format","Intl","NumberFormat","autotranslateButton","saveAllBtn","saveAllModal","langstrings","selectAllBtn","removedIframes","allDataFormatOne","checkboxes","checkBoxParentMap","Map","optionsForTiny","subdirs","maxbytes","maxfiles","noclean","trusttext","enable_filemanagement","autosave","removeorphaneddrafts","plugins","cachedSelectors","wordCount","document","querySelector","statuses","wordcount","charWithSpace","charNumWithSpace","charWOSpace","charNumWithOutSpace","deeplUseSpan","deeplUsage","deeplMaxSpan","deeplMax","deeplStatusContainer","doHideiframes","isChecked","domQuery","actions","hideiframes","allIframes","domQueryAll","sourcetexts","iframes","length","forEach","iframe","push","parent","parentNode","nextSibling","html","outerHTML","remove","info","tempDiv","createElement","innerHTML","newIframe","firstChild","insertBefore","appendChild","findEditorByType","key","editorType","et","ed","editors","types","atto","findTinyInstanceByKey","other","editor","getAllInstances","every","k","v","attributes","name","value","indexOf","getBody","countWordAndChar","wrdsc","cws","cwos","Array","from","checkedCheckBoxes","ckBox","getAttribute","results","getCount","current","usage","character","count","innerText","limit","classList","toggle","raw","keys","trimmedVal","stripHTMLTags","fromBase64","trim","match","replace","toggleStatus","checked","translated","icon","validatorBtn","status","dataset","wait","emit","setIconElementStatus","totranslate","tosave","failed","success","saved","isBtn","contains","add","setAttribute","title","statusstrings","getIconStatus","launchModal","async","create","messageObject","show","dbErrorModal","body","titleSuffix","uistrings","errordbtitle","presentDialogModal","type","removeOnClose","resizeEditors","editable","id","selector","grandparent","parentElement","resizeObserver","ResizeObserver","totalHeight","offsetHeight","style","height","updateEditableHeight","observe","toggleAutotranslateButton","disabled","some","e","debouncedShowRows","debounce","showRows","selectorMap","updated","showUpdated","needsupdate","showNeedUpdate","hidden","showHidden","mergedSelector","Object","join","allItems","allSelected","item","shouldShow","shouldCheck","entries","matches","rowId","hiddenForStudentRows","child","childId","toggleChildCheckBoxSelection","shouldBeChecked","multiples","checkBoxesWithKey","disableSaveButton","ON_STATUS_CHANGED","backToBase","offsetTop","window","scrollTo","top","behavior","dbErrorPartialModal","stringVar","errordbpartial","disableTranslateButton","enableSaveButton","enableTranslateButton","deeplErrorModal","deeplapiexception","findEditor","basic","r","userPrefs","warn","error","trace","hideModal","isVisible","hide","hideErrorMessage","editorsWithKey","alertChild","removeChild","init","cfg","glossary","entriesviewerPage","autoTranslateBtn","checkBoxes","targetarea","saveAll","JSON","parse","targetlang","node","launchSaveAllModal","saveallmodaltitle","saveallmodalbody","then","catch","reason","launchTranslatingModal","translatemodaltitle","translatemodalbody","setIconStatus","showEntriesModal","ajaxResponse","glossaryid","message","table","className","thead","source","toUpperCase","target","tbody","_ref","row","showErrorMessageForEditor","errorMsg","substring","errortoolong","toggleAllCheckboxes","updates","checkbox","has","get","getParentRow","parentrow","set","requestAnimationFrame","_ref2","toggleGlossaryDetails","glossaryId","display","wrapTinyOnTarget","element","getTinyMCE","setupForTarget"],"mappings":"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"}