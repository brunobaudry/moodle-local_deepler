define(["./local/selectors","./local/api","./local/customevents","core/modal","core/log"],function(t,a,r,o,s){let l="",n=e=>{l=e;let t=document.getElementById("local_deepler/fileElem"),a=document.getElementById("local_deepler/filename-display"),r=document.getElementById("local_deepler/createglossary");t.addEventListener("change",function(){s.info("change"),0<t.files.length?(a.classList.remove("invisible"),r.classList.remove("invisible")):(a.classList.add("invisible"),r.classList.add("invisible"))})},d=e=>{var t=e.glossaryid,a=JSON.parse(e.entries),s=e.status,r=e.message;if("success"===s){var s=document.createElement("table"),l=(s.className="generaltable",document.createElement("thead"));l.innerHTML=`<tr><th>${e.source.toUpperCase()}</th><th>${e.target.toUpperCase()}</th></tr>`,s.appendChild(l);let r=document.createElement("tbody");Object.entries(a).forEach(([e,t])=>{var a=document.createElement("tr");a.innerHTML=`<td>${e}</td><td>${t}</td>`,r.appendChild(a)}),s.appendChild(r),o.create({title:"Entries",body:s,type:"default",show:!0,removeOnClose:!0})}else o.create({title:`Error fetching entries for<br/><em>${t}</em>`,body:r,type:"default",show:!0,removeOnClose:!0})};return{init:function(e){"loading"!==document.readyState?(n(e),document.querySelectorAll(t.glossary.visibilityDropdown).forEach(e=>{e.addEventListener("change",e=>{s.info(e.target.dataset.glossary,e.target.value),a.updateGlossariesVisibility(e.target.dataset.glossary,e.target.value)})}),e=document.querySelectorAll(t.glossary.entriesviewer),s.info(e),e.forEach(e=>{e.addEventListener("click",e=>{0!==e.target.dataset.length&&void 0!==e.target.dataset.glossary?(s.info(e.target.dataset.glossary),a.getGlossariesEntries(e.target.dataset.glossary,l)):e.target.parentNode.dataset&&e.target.parentNode.dataset.glossary?(s.info(e.target.parentNode.dataset.glossary),a.getGlossariesEntries(e.target.parentNode.dataset.glossary,l)):s.error("Cannot not find glossary ID")})}),r.on(a.GLOSSARY_ENTRIES_SUCCESS,d),r.on(a.GLOSSARY_ENTRIES_FAILED,e=>{s.error(a.GLOSSARY_ENTRIES_FAILED),s.error(e)})):document.addEventListener("DOMContentLoaded",n)}}});